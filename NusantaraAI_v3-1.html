<!DOCTYPE html>
<html lang="id" data-theme="dark">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NusantaraAI v3.0</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&family=Fraunces:ital,wght@0,400;0,700;1,400&display=swap');

[data-theme="dark"]{
--bg:#0a0f1a;--surface:#111827;--s2:#1a2236;--s3:#1e2a40;--s4:#243048;
--accent:#60a5fa;--a2:#34d399;--a3:#fb7185;--gold:#fbbf24;--purple:#a78bfa;--cyan:#22d3ee;
--text:#f1f5f9;--tm:#94a3b8;--ub:#2563eb;--ab:#1a2236;--border:#1e2a40;
--glow:rgba(96,165,250,.15);--card:rgba(255,255,255,.03);}
[data-theme="light"]{
--bg:#f8faff;--surface:#ffffff;--s2:#f0f4ff;--s3:#e8eefb;--s4:#dde5f7;
--accent:#2563eb;--a2:#059669;--a3:#e11d48;--gold:#d97706;--purple:#7c3aed;--cyan:#0891b2;
--text:#0f172a;--tm:#64748b;--ub:#2563eb;--ab:#f0f4ff;--border:#e2e8f0;
--glow:rgba(37,99,235,.08);--card:rgba(0,0,0,.02);}

*{margin:0;padding:0;box-sizing:border-box}
html,body{height:100%;font-family:'Plus Jakarta Sans',sans-serif;background:var(--bg);color:var(--text);transition:background .3s,color .3s}
body{display:flex;flex-direction:column;overflow:hidden}

/* animated BG orbs */
.orb{position:fixed;border-radius:50%;filter:blur(80px);pointer-events:none;z-index:0;opacity:.5}
.orb1{width:500px;height:500px;background:radial-gradient(circle,rgba(96,165,250,.12),transparent);top:-100px;left:-100px;animation:float1 12s ease-in-out infinite}
.orb2{width:400px;height:400px;background:radial-gradient(circle,rgba(52,211,153,.08),transparent);bottom:-80px;right:-80px;animation:float2 15s ease-in-out infinite}
.orb3{width:300px;height:300px;background:radial-gradient(circle,rgba(167,139,250,.07),transparent);top:50%;right:20%;animation:float3 10s ease-in-out infinite}
@keyframes float1{0%,100%{transform:translate(0,0)}50%{transform:translate(40px,30px)}}
@keyframes float2{0%,100%{transform:translate(0,0)}50%{transform:translate(-30px,-40px)}}
@keyframes float3{0%,100%{transform:translate(0,0)}50%{transform:translate(20px,-25px)}}
[data-theme="light"] .orb{opacity:.3}

/* â”€â”€ HEADER â”€â”€ */
header{position:relative;z-index:100;display:flex;align-items:center;gap:10px;padding:11px 18px;
border-bottom:1px solid var(--border);background:rgba(10,15,26,.96);backdrop-filter:blur(20px);flex-shrink:0}
[data-theme="light"] header{background:rgba(255,255,255,.96)}
.hlogo{display:flex;align-items:center;gap:10px;flex:1;min-width:0}
.ai-orb{width:38px;height:38px;border-radius:50%;background:conic-gradient(from 0deg,#60a5fa,#34d399,#fbbf24,#a78bfa,#60a5fa);
display:flex;align-items:center;justify-content:center;font-size:17px;flex-shrink:0;
box-shadow:0 0 20px rgba(96,165,250,.4);animation:spin-orb 8s linear infinite}
@keyframes spin-orb{to{filter:hue-rotate(360deg)}}
.htitle{font-family:'Fraunces',serif;font-size:16px;font-weight:700;background:linear-gradient(90deg,#60a5fa,#34d399);
-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;line-height:1}
.hsub{font-size:10px;color:var(--tm);display:flex;align-items:center;gap:4px;margin-top:2px}
.vbadge{background:linear-gradient(90deg,#a78bfa,#60a5fa);color:#fff;font-size:9px;padding:1px 5px;border-radius:6px;font-weight:700}
.hright{display:flex;align-items:center;gap:6px;flex-shrink:0}
.hbtn{width:30px;height:30px;border-radius:8px;background:var(--s2);border:1px solid var(--border);
cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:13px;color:var(--tm);transition:.2s}
.hbtn:hover{background:var(--s3);color:var(--text);transform:scale(1.05)}
.onpill{display:flex;align-items:center;gap:5px;padding:4px 9px;border-radius:20px;
background:rgba(52,211,153,.1);border:1px solid rgba(52,211,153,.25);font-size:10px;color:var(--a2);white-space:nowrap}
.pdot{width:5px;height:5px;border-radius:50%;background:var(--a2);animation:blink 2s infinite}
@keyframes blink{0%,100%{opacity:1}50%{opacity:.3}}

/* â”€â”€ CHIPS BAR â”€â”€ */
.cbar{position:relative;z-index:90;display:flex;gap:5px;padding:7px 16px;
border-bottom:1px solid var(--border);background:var(--surface);overflow-x:auto;flex-shrink:0;scrollbar-width:none}
.cbar::-webkit-scrollbar{display:none}
.chip{white-space:nowrap;padding:4px 11px;border-radius:20px;border:1px solid var(--border);
font-size:11px;color:var(--tm);cursor:pointer;transition:.2s;background:transparent;font-family:inherit;flex-shrink:0}
.chip:hover,.chip.on{background:rgba(96,165,250,.12);border-color:var(--accent);color:var(--accent)}

/* â”€â”€ STATS â”€â”€ */
.sbar{display:flex;gap:14px;padding:6px 18px;border-bottom:1px solid var(--border);
background:var(--surface);font-size:10px;color:var(--tm);flex-shrink:0;overflow-x:auto;scrollbar-width:none}
.sbar::-webkit-scrollbar{display:none}
.si{display:flex;align-items:center;gap:4px;flex-shrink:0;white-space:nowrap}
.sv{color:var(--accent);font-weight:700}
.mood-pill{display:inline-flex;align-items:center;gap:3px;padding:1px 7px;border-radius:10px;
background:rgba(96,165,250,.1);border:1px solid rgba(96,165,250,.2);font-size:10px;color:var(--accent)}

/* â”€â”€ LAYOUT â”€â”€ */
.wrap{flex:1;display:flex;overflow:hidden;position:relative;z-index:5}

/* â”€â”€ SIDEBAR â”€â”€ */
.side{width:230px;flex-shrink:0;border-right:1px solid var(--border);background:var(--surface);
display:flex;flex-direction:column;overflow:hidden;transition:transform .3s;z-index:50}
.side-hdr{padding:12px 14px 8px;border-bottom:1px solid var(--border);
font-size:10px;font-weight:700;color:var(--tm);text-transform:uppercase;letter-spacing:.8px;
display:flex;justify-content:space-between;align-items:center}
.clr-btn{background:none;border:none;cursor:pointer;color:var(--tm);font-size:10px;
font-family:inherit;padding:2px 6px;border-radius:6px;transition:.2s}
.clr-btn:hover{background:rgba(251,113,133,.12);color:var(--a3)}
.sfeat{padding:8px 10px;display:flex;flex-direction:column;gap:3px}
.fb{display:flex;align-items:center;gap:8px;padding:8px 10px;border-radius:9px;border:none;
background:transparent;cursor:pointer;font-family:inherit;font-size:12px;color:var(--text);text-align:left;transition:.2s;width:100%}
.fb:hover{background:var(--s2)}
.fi{font-size:15px;flex-shrink:0}
.hlist{flex:1;overflow-y:auto;padding:0 8px 8px;display:flex;flex-direction:column;gap:2px}
.hlist::-webkit-scrollbar{width:3px}
.hlist::-webkit-scrollbar-thumb{background:var(--border);border-radius:2px}
.hi{padding:7px 9px;border-radius:7px;font-size:11px;color:var(--tm);cursor:pointer;
white-space:nowrap;overflow:hidden;text-overflow:ellipsis;transition:.2s;border:1px solid transparent}
.hi:hover{background:var(--s2);border-color:var(--border);color:var(--text)}

/* â”€â”€ CHAT â”€â”€ */
.cwrap{flex:1;display:flex;flex-direction:column;overflow:hidden}
#ca{flex:1;overflow-y:auto;padding:18px 22px;scroll-behavior:smooth}
#ca::-webkit-scrollbar{width:3px}
#ca::-webkit-scrollbar-track{background:transparent}
#ca::-webkit-scrollbar-thumb{background:var(--border);border-radius:2px}

/* â”€â”€ MESSAGES â”€â”€ */
.m{display:flex;gap:9px;margin-bottom:16px;animation:min .3s ease forwards;opacity:0}
@keyframes min{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}
.m.u{flex-direction:row-reverse}
.mav{width:30px;height:30px;border-radius:50%;display:flex;align-items:center;
justify-content:center;font-size:13px;flex-shrink:0;margin-top:2px}
.m.ai .mav{background:linear-gradient(135deg,#60a5fa,#34d399);box-shadow:0 0 10px rgba(96,165,250,.3)}
.m.u .mav{background:linear-gradient(135deg,#fbbf24,#fb7185)}
.bbl{max-width:76%;padding:10px 14px;border-radius:18px;font-size:13.5px;line-height:1.7;position:relative}
.m.ai .bbl{background:var(--ab);border:1px solid var(--border);border-top-left-radius:4px;color:var(--text)}
.m.u .bbl{background:var(--ub);border-top-right-radius:4px;color:#fff}
.bbl strong{color:var(--accent)}
.bbl .hl{color:var(--gold);font-weight:600}
.bbl pre{background:rgba(0,0,0,.35);border:1px solid var(--border);border-radius:7px;
padding:9px 11px;margin:7px 0;font-family:'Courier New',monospace;font-size:11px;
color:#7dd3fc;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word}
[data-theme="light"] .bbl pre{background:rgba(0,0,0,.04);color:var(--accent)}
.bbl .ci{background:rgba(96,165,250,.12);padding:1px 5px;border-radius:4px;
font-family:monospace;font-size:11.5px;color:var(--accent)}
.mmeta{font-size:9.5px;color:var(--tm);margin-top:3px;padding:0 4px}
.m.u .mmeta{text-align:right}
.react-btns{display:flex;gap:4px;margin-top:4px;padding:0 4px;opacity:0;transition:.2s}
.m:hover .react-btns{opacity:1}
.rbtn{background:var(--s2);border:1px solid var(--border);border-radius:8px;
font-size:12px;cursor:pointer;padding:2px 7px;transition:.2s}
.rbtn:hover{background:var(--s3);transform:scale(1.1)}

/* â”€â”€ TYPING â”€â”€ */
.twrap{display:flex;gap:5px;align-items:center;padding:11px 14px}
.td{width:6px;height:6px;border-radius:50%;background:var(--accent);animation:tb 1.2s infinite}
.td:nth-child(2){animation-delay:.2s}.td:nth-child(3){animation-delay:.4s}
@keyframes tb{0%,80%,100%{transform:scale(.7);opacity:.5}40%{transform:scale(1);opacity:1}}

/* â”€â”€ WELCOME â”€â”€ */
#wel{text-align:center;padding:28px 16px;animation:min .5s ease forwards}
#wel h2{font-family:'Fraunces',serif;font-size:clamp(20px,4vw,32px);font-weight:700;
background:linear-gradient(135deg,#60a5fa,#34d399,#fbbf24);
-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;margin-bottom:8px}
#wel p{color:var(--tm);font-size:13px;max-width:440px;margin:0 auto 20px;line-height:1.6}
.sgrid{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:7px;max-width:560px;margin:0 auto}
.sb{background:var(--surface);border:1px solid var(--border);border-radius:11px;
padding:11px 13px;text-align:left;cursor:pointer;transition:.25s;font-family:inherit;
font-size:12px;color:var(--text)}
.sb:hover{background:rgba(96,165,250,.07);border-color:rgba(96,165,250,.35);
transform:translateY(-2px);box-shadow:0 5px 15px rgba(96,165,250,.08)}
.sb .ic{font-size:17px;margin-bottom:4px;display:block}
.sb .lb{color:var(--tm);font-size:10px;margin-top:2px}

/* â”€â”€ SPECIAL CARDS â”€â”€ */
.card{background:var(--s2);border:1px solid var(--border);border-radius:12px;padding:14px;margin:7px 0}
.card-title{font-weight:700;color:var(--text);margin-bottom:10px;font-size:13px;
display:flex;align-items:center;gap:6px}
.tag{display:inline-block;padding:2px 8px;border-radius:10px;font-size:10px;margin-bottom:6px}
.tag.i{background:rgba(96,165,250,.1);color:var(--accent);border:1px solid rgba(96,165,250,.2)}
.tag.g{background:rgba(52,211,153,.1);color:var(--a2);border:1px solid rgba(52,211,153,.2)}
.tag.r{background:rgba(251,113,133,.1);color:var(--a3);border:1px solid rgba(251,113,133,.2)}
.tag.y{background:rgba(251,191,36,.1);color:var(--gold);border:1px solid rgba(251,191,36,.2)}

/* QUIZ */
.qopts{display:flex;flex-direction:column;gap:5px;margin-top:8px}
.qo{padding:8px 12px;border-radius:8px;border:1px solid var(--border);background:var(--s3);
cursor:pointer;font-size:12px;font-family:inherit;color:var(--text);text-align:left;transition:.2s}
.qo:hover:not(:disabled){background:rgba(96,165,250,.1);border-color:var(--accent)}
.qo.ok{background:rgba(52,211,153,.12);border-color:var(--a2);color:var(--a2);font-weight:700}
.qo.no{background:rgba(251,113,133,.12);border-color:var(--a3);color:var(--a3)}
.qres{margin-top:8px;padding:7px 11px;border-radius:8px;font-size:12px;font-weight:600}

/* WORD GAME */
.wg-word{display:flex;gap:6px;justify-content:center;flex-wrap:wrap;margin:10px 0}
.wg-l{width:34px;height:40px;border-bottom:2px solid var(--border);display:flex;
align-items:center;justify-content:center;font-size:18px;font-weight:700;color:var(--text);
transition:.3s;text-transform:uppercase}
.wg-l.shown{border-color:var(--a2);color:var(--a2)}
.wg-kb{display:flex;flex-wrap:wrap;gap:4px;justify-content:center;margin-top:10px}
.wgk{width:28px;height:28px;border-radius:6px;border:1px solid var(--border);background:var(--s3);
cursor:pointer;font-size:11px;font-family:inherit;color:var(--text);font-weight:600;transition:.2s}
.wgk:hover:not(:disabled){background:var(--accent);color:#fff;border-color:var(--accent)}
.wgk:disabled.hit{background:rgba(52,211,153,.2);border-color:var(--a2);color:var(--a2)}
.wgk:disabled.miss{background:var(--s2);border-color:var(--border);color:var(--tm);opacity:.5}
.hangman{font-family:monospace;font-size:11px;color:var(--tm);white-space:pre;
background:rgba(0,0,0,.15);padding:8px 14px;border-radius:8px;margin:6px 0;line-height:1.2}

/* TRANSLATE */
.tbox{display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-top:8px}
.tpanel{background:var(--s3);border-radius:8px;padding:10px 12px;font-size:12px;color:var(--text);
border:1px solid var(--border);min-height:60px;line-height:1.6;word-break:break-word}
.tlabel{font-size:10px;color:var(--tm);font-weight:700;text-transform:uppercase;letter-spacing:.5px;margin-bottom:4px}

/* CONVERTER */
.cvgrid{display:grid;grid-template-columns:1fr auto 1fr;align-items:center;gap:8px;margin-top:8px}
.cvinp{background:var(--s3);border:1px solid var(--border);border-radius:8px;
padding:8px 10px;font-size:14px;font-weight:700;color:var(--text);text-align:center;
font-family:inherit;width:100%;outline:none;transition:.2s}
.cvinp:focus{border-color:var(--accent)}
.cvarrow{font-size:18px;color:var(--accent)}
.cvres{font-size:14px;font-weight:700;color:var(--a2);text-align:center}
.cvunit{font-size:10px;color:var(--tm);text-align:center;margin-top:2px}

/* CALC */
.cdisp{background:var(--bg);border:1px solid var(--border);border-radius:8px;
padding:9px 13px;font-family:monospace;font-size:18px;color:var(--accent);
margin-bottom:9px;min-height:44px;text-align:right;word-break:break-all}
.cgrid{display:grid;grid-template-columns:repeat(4,1fr);gap:5px}
.ck{padding:9px;border-radius:7px;border:1px solid var(--border);background:var(--s3);
cursor:pointer;font-size:13px;font-family:inherit;color:var(--text);transition:.15s}
.ck:hover{background:var(--s2);transform:scale(1.04)}
.ck.op{color:var(--accent);font-weight:700}
.ck.eq{background:linear-gradient(135deg,#60a5fa,#34d399);color:#fff;border:none;font-weight:700}
.ck.cl{color:var(--a3)}

/* RECIPE */
.rlist{list-style:none;padding:0;display:flex;flex-direction:column;gap:4px}
.rlist li{display:flex;align-items:flex-start;gap:6px;font-size:12px;padding:4px 0;
border-bottom:1px solid var(--border)}
.rlist li:last-child{border:none}
.rnum{color:var(--accent);font-weight:700;min-width:18px;font-size:11px;margin-top:1px}

/* â”€â”€ INPUT â”€â”€ */
.iarea{position:relative;z-index:10;padding:12px 18px;background:var(--bg);
border-top:1px solid var(--border);flex-shrink:0}
[data-theme="light"] .iarea{background:var(--surface)}
.ibox{display:flex;align-items:flex-end;gap:7px;background:var(--surface);
border:1px solid var(--border);border-radius:14px;padding:8px 11px;transition:.2s}
.ibox:focus-within{border-color:rgba(96,165,250,.5);box-shadow:0 0 0 3px rgba(96,165,250,.06)}
#ui{flex:1;background:transparent;border:none;outline:none;font-family:inherit;
font-size:13px;color:var(--text);resize:none;line-height:1.5;max-height:100px;overflow-y:auto}
#ui::placeholder{color:var(--tm)}
.ibtns{display:flex;gap:5px;align-items:center}
.ib{width:28px;height:28px;border-radius:7px;border:none;background:var(--s2);cursor:pointer;
display:flex;align-items:center;justify-content:center;font-size:12px;color:var(--tm);transition:.2s}
.ib:hover{background:var(--s3);color:var(--text)}
#sb{width:34px;height:34px;border-radius:9px;flex-shrink:0;
background:linear-gradient(135deg,#60a5fa,#34d399);border:none;cursor:pointer;
display:flex;align-items:center;justify-content:center;font-size:14px;color:#fff;transition:.2s}
#sb:hover{transform:scale(1.08);box-shadow:0 4px 14px rgba(96,165,250,.4)}
#sb:active{transform:scale(.95)}
.ihint{font-size:10px;color:var(--tm);text-align:center;margin-top:6px;
display:flex;align-items:center;justify-content:center;gap:10px}
.hs{opacity:.3}

/* â”€â”€ MODAL â”€â”€ */
.mdbg{position:fixed;inset:0;background:rgba(0,0,0,.65);z-index:1000;
display:flex;align-items:center;justify-content:center;backdrop-filter:blur(5px);
opacity:0;pointer-events:none;transition:.3s}
.mdbg.show{opacity:1;pointer-events:all}
.md{background:var(--surface);border:1px solid var(--border);border-radius:16px;
padding:20px;max-width:440px;width:92%;transform:scale(.9);transition:.3s;max-height:85vh;overflow-y:auto}
.mdbg.show .md{transform:scale(1)}
.md h3{font-size:16px;margin-bottom:4px;color:var(--text);font-family:'Fraunces',serif}
.md p{font-size:12px;color:var(--tm);margin-bottom:14px;line-height:1.6}
.mclose{float:right;background:none;border:none;cursor:pointer;font-size:18px;color:var(--tm)}
.mclose:hover{color:var(--text)}
.mgrid{display:grid;grid-template-columns:1fr 1fr;gap:7px;margin:10px 0}
.mc{background:var(--s2);border-radius:9px;padding:10px;font-size:11px}
.mc .mci{font-size:18px;margin-bottom:3px}
.mc .mcl{font-weight:700;color:var(--text)}
.mc .mcs{color:var(--tm);margin-top:2px}

/* â”€â”€ RESPONSIVE â”€â”€ */
@media(max-width:680px){
.side{position:absolute;left:0;top:0;height:100%;transform:translateX(-100%);box-shadow:4px 0 20px rgba(0,0,0,.4)}
.side.open{transform:translateX(0)}
.bbl{max-width:88%}
#ca{padding:12px}
.iarea{padding:10px 12px}
.tbox{grid-template-columns:1fr}}

/* scrollbar global */
::-webkit-scrollbar{width:3px;height:3px}
::-webkit-scrollbar-thumb{background:var(--border);border-radius:2px}
</style>
</head>
<body>
<div class="orb orb1"></div><div class="orb orb2"></div><div class="orb orb3"></div>

<!-- HEADER -->
<header>
  <div class="hlogo">
    <button class="hbtn" onclick="toggleSide()" title="Menu">â˜°</button>
    <div class="ai-orb">ğŸŒŸ</div>
    <div>
      <div class="htitle">NusantaraAI</div>
      <div class="hsub">v3.0 &nbsp;<span class="vbadge">PRO</span></div>
    </div>
  </div>
  <div class="hright">
    <div class="onpill"><div class="pdot"></div>Offline</div>
    <button class="hbtn" title="Tema" onclick="toggleTheme()">ğŸŒ™</button>
    <button class="hbtn" title="Kalkulator" onclick="openModal('mdcalc')">ğŸ”¢</button>
    <button class="hbtn" title="Info" onclick="openModal('mdinfo')">â„¹ï¸</button>
  </div>
</header>

<!-- CHIPS -->
<div class="cbar" id="cbar">
  <button class="chip on" onclick="chipClick(this,'semua')">âœ¨ Semua</button>
  <button class="chip" onclick="chipClick(this,'sains')">ğŸ”¬ Sains</button>
  <button class="chip" onclick="chipClick(this,'teknologi')">ğŸ’» Teknologi</button>
  <button class="chip" onclick="chipClick(this,'sejarah')">ğŸ“œ Sejarah</button>
  <button class="chip" onclick="chipClick(this,'matematika')">ğŸ“ Matematika</button>
  <button class="chip" onclick="chipClick(this,'bahasa')">ğŸ“– Bahasa</button>
  <button class="chip" onclick="chipClick(this,'budaya')">ğŸ­ Budaya</button>
  <button class="chip" onclick="chipClick(this,'kesehatan')">ğŸ’Š Kesehatan</button>
  <button class="chip" onclick="chipClick(this,'olahraga')">âš½ Olahraga</button>
  <button class="chip" onclick="chipClick(this,'ekonomi')">ğŸ’° Ekonomi</button>
  <button class="chip" onclick="chipClick(this,'psikologi')">ğŸ§  Psikologi</button>
  <button class="chip" onclick="chipClick(this,'motivasi')">ğŸ’¡ Motivasi</button>
  <button class="chip" onclick="chipClick(this,'trivia')">ğŸ² Trivia</button>
  <button class="chip" onclick="chipClick(this,'geografi')">ğŸ—ºï¸ Geografi</button>
  <button class="chip" onclick="chipClick(this,'memasak')">ğŸ³ Masak</button>
  <button class="chip" onclick="chipClick(this,'hukum')">âš–ï¸ Hukum</button>
  <button class="chip" onclick="chipClick(this,'parenting')">ğŸ‘¶ Parenting</button>
  <button class="chip" onclick="chipClick(this,'alam')">ğŸŒ¿ Alam</button>
</div>

<!-- STATS BAR -->
<div class="sbar">
  <div class="si">ğŸ’¬ <span class="sv" id="st-msg">0</span> pesan</div>
  <div class="si">ğŸ† Kuis: <span class="sv" id="st-q">0</span>/<span id="st-qt">0</span></div>
  <div class="si">ğŸ® Skor: <span class="sv" id="st-sc">0</span></div>
  <div class="si">â± <span class="sv" id="st-t">0:00</span></div>
  <div class="si">ğŸ“š KB: <span class="sv">2500+</span></div>
  <div class="si">ğŸ˜Š Mood: <span class="sv mood-pill" id="st-mood">Netral ğŸ˜Š</span></div>
</div>

<!-- MAIN -->
<div class="wrap">
  <!-- SIDEBAR -->
  <div class="side" id="side">
    <div class="side-hdr">Fitur Cepat</div>
    <div class="sfeat">
      <button class="fb" onclick="qs('mulai kuis')"><span class="fi">ğŸ®</span>Kuis Interaktif</button>
      <button class="fb" onclick="qs('mulai game tebak kata')"><span class="fi">ğŸ”¤</span>Tebak Kata</button>
      <button class="fb" onclick="qs('translate')"><span class="fi">ğŸŒ</span>Terjemahan</button>
      <button class="fb" onclick="qs('konverter')"><span class="fi">ğŸ”„</span>Konverter Unit</button>
      <button class="fb" onclick="openModal('mdcalc')"><span class="fi">ğŸ”¢</span>Kalkulator</button>
      <button class="fb" onclick="qs('fakta acak')"><span class="fi">ğŸ²</span>Fakta Acak</button>
      <button class="fb" onclick="qs('resep masakan sederhana')"><span class="fi">ğŸ³</span>Resep Masakan</button>
      <button class="fb" onclick="qs('cerita motivasi')"><span class="fi">ğŸ’ª</span>Cerita Inspirasi</button>
    </div>
    <div class="side-hdr" style="margin-top:4px">Riwayat <button class="clr-btn" onclick="clearHist()">Hapus</button></div>
    <div class="hlist" id="hlist"><div style="font-size:11px;color:var(--tm);padding:8px;text-align:center">Belum ada riwayat</div></div>
  </div>

  <!-- CHAT + INPUT -->
  <div class="cwrap">
    <div id="ca">
      <div id="wel">
        <h2>Halo! Saya NusantaraAI ğŸŒŸ</h2>
        <p>Versi 3.0 â€” Lebih cerdas, lebih lengkap, lebih ramah dari sebelumnya!</p>
        <div class="sgrid">
          <button class="sb" onclick="qs('Kuis pengetahuan umum')"><span class="ic">ğŸ®</span>Mulai Kuis<div class="lb">Interaktif & seru</div></button>
          <button class="sb" onclick="qs('mulai game tebak kata')"><span class="ic">ğŸ”¤</span>Tebak Kata<div class="lb">Game seru</div></button>
          <button class="sb" onclick="qs('terjemahkan halo apa kabar ke inggris')"><span class="ic">ğŸŒ</span>Terjemahkan<div class="lb">Indonesia â†” Inggris</div></button>
          <button class="sb" onclick="qs('konverter suhu celsius fahrenheit')"><span class="ic">ğŸ”„</span>Konverter Unit<div class="lb">Suhu, panjang, berat</div></button>
          <button class="sb" onclick="qs('resep nasi goreng spesial')"><span class="ic">ğŸ³</span>Resep Masakan<div class="lb">Masakan nusantara</div></button>
          <button class="sb" onclick="qs('fakta ilmiah yang mengejutkan')"><span class="ic">ğŸ”¬</span>Fakta Sains<div class="lb">Bikin takjub</div></button>
        </div>
      </div>
    </div>

    <div class="iarea">
      <div class="ibox">
        <textarea id="ui" rows="1" placeholder="Tanya apa saja... ketik atau pilih fitur di atas ğŸ˜Š"></textarea>
        <div class="ibtns">
          <button class="ib" title="Kuis" onclick="qs('mulai kuis')">ğŸ®</button>
          <button class="ib" title="Game" onclick="qs('mulai game tebak kata')">ğŸ”¤</button>
          <button class="ib" title="Terjemah" onclick="qs('translate')">ğŸŒ</button>
          <button id="sb" onclick="send()" title="Kirim">â¤</button>
        </div>
      </div>
      <div class="ihint">
        <span>ğŸ’¡ 100% Offline</span><span class="hs">|</span>
        <span>ğŸ“š 2500+ Topik</span><span class="hs">|</span>
        <span>ğŸ® Kuis â€¢ Game â€¢ Konverter</span>
      </div>
    </div>
  </div>
</div>

<!-- MODAL INFO -->
<div class="mdbg" id="mdinfo">
  <div class="md">
    <button class="mclose" onclick="closeModal('mdinfo')">Ã—</button>
    <h3>ğŸŒŸ NusantaraAI v3.0</h3>
    <p>Asisten AI offline paling canggih â€” berjalan 100% di browser!</p>
    <div class="mgrid">
      <div class="mc"><div class="mci">ğŸ“š</div><div class="mcl">2500+ Topik</div><div class="mcs">18 kategori pengetahuan</div></div>
      <div class="mc"><div class="mci">ğŸ®</div><div class="mcl">Kuis Interaktif</div><div class="mcs">50+ soal acak</div></div>
      <div class="mc"><div class="mci">ğŸ”¤</div><div class="mcl">Tebak Kata</div><div class="mcs">Game hangman seru</div></div>
      <div class="mc"><div class="mci">ğŸŒ</div><div class="mcl">Terjemahan</div><div class="mcs">Indonesia â†” Inggris</div></div>
      <div class="mc"><div class="mci">ğŸ”„</div><div class="mcl">Konverter</div><div class="mcs">Suhu, panjang, berat</div></div>
      <div class="mc"><div class="mci">ğŸ”¢</div><div class="mcl">Kalkulator</div><div class="mcs">Scientific calculator</div></div>
      <div class="mc"><div class="mci">ğŸ³</div><div class="mcl">Resep Masakan</div><div class="mcs">10+ resep nusantara</div></div>
      <div class="mc"><div class="mci">ğŸŒ™</div><div class="mcl">Mode Gelap/Terang</div><div class="mcs">Sesuai selera</div></div>
    </div>
    <p style="font-size:11px;margin:0">Dibuat dengan â¤ï¸ untuk Indonesia â€” NusantaraAI v3.0 PRO</p>
  </div>
</div>

<!-- MODAL CALC -->
<div class="mdbg" id="mdcalc">
  <div class="md" style="max-width:300px">
    <button class="mclose" onclick="closeModal('mdcalc')">Ã—</button>
    <h3>ğŸ”¢ Kalkulator</h3>
    <div class="card" style="margin:10px 0">
      <div class="cdisp" id="cdisp">0</div>
      <div class="cgrid">
        <button class="ck cl" onclick="ca('C')">C</button>
        <button class="ck op" onclick="ca('(')">(</button>
        <button class="ck op" onclick="ca(')')">)</button>
        <button class="ck op" onclick="ca('/')">Ã·</button>
        <button class="ck" onclick="ca('7')">7</button><button class="ck" onclick="ca('8')">8</button>
        <button class="ck" onclick="ca('9')">9</button><button class="ck op" onclick="ca('*')">Ã—</button>
        <button class="ck" onclick="ca('4')">4</button><button class="ck" onclick="ca('5')">5</button>
        <button class="ck" onclick="ca('6')">6</button><button class="ck op" onclick="ca('-')">âˆ’</button>
        <button class="ck" onclick="ca('1')">1</button><button class="ck" onclick="ca('2')">2</button>
        <button class="ck" onclick="ca('3')">3</button><button class="ck op" onclick="ca('+')">+</button>
        <button class="ck" onclick="ca('0')" style="grid-column:span 2">0</button>
        <button class="ck" onclick="ca('.')">.</button>
        <button class="ck eq" onclick="ca('=')">=</button>
      </div>
    </div>
  </div>
</div>

<script>
// ================================================================
//  NUSANTARAAI v3.0 â€” FULL ENGINE
// ================================================================
let msgCount=0, quizRight=0, quizTotal=0, totalScore=0;
let userName='', userMood='netral';
let sessionStart=Date.now();
let sideOpen=false, processing=false;

// ================================================================
//  FULL DICTIONARY: Indonesia â†” English (500+ kata)
// ================================================================
const DICT_ID_EN = {
  "halo":"hello","hai":"hi","selamat":"congratulations / greetings","pagi":"morning",
  "siang":"afternoon","malam":"evening/night","terima kasih":"thank you","sama-sama":"you're welcome",
  "maaf":"sorry","tolong":"please / help","ya":"yes","tidak":"no","apa":"what","siapa":"who",
  "kapan":"when","di mana":"where","mengapa":"why","bagaimana":"how","ini":"this","itu":"that",
  "saya":"I / me","kamu":"you","dia":"he / she","kami":"we (excl.)","kita":"we (incl.)","mereka":"they",
  "makan":"eat","minum":"drink","tidur":"sleep","belajar":"study / learn","bekerja":"work",
  "bermain":"play","berlari":"run","berjalan":"walk","bicara":"speak / talk","menulis":"write",
  "membaca":"read","mendengar":"listen","melihat":"see / look","pergi":"go","datang":"come",
  "rumah":"house / home","sekolah":"school","kantor":"office","pasar":"market","toko":"store / shop",
  "jalan":"road / street","air":"water","api":"fire","tanah":"soil / earth","langit":"sky",
  "matahari":"sun","bulan":"moon","bintang":"star","angin":"wind","hujan":"rain","panas":"hot",
  "dingin":"cold","besar":"big / large","kecil":"small / little","tinggi":"tall / high","pendek":"short",
  "panjang":"long","lebar":"wide","baru":"new","lama":"old / long (time)","cepat":"fast / quick",
  "lambat":"slow","baik":"good","buruk":"bad","cantik":"beautiful","tampan":"handsome",
  "pintar":"smart / intelligent","bodoh":"stupid (informal)","kaya":"rich","miskin":"poor",
  "senang":"happy","sedih":"sad","marah":"angry","takut":"afraid","berani":"brave","lelah":"tired",
  "lapar":"hungry","kenyang":"full (satiated)","buku":"book","pensil":"pencil","meja":"table","kursi":"chair",
  "pintu":"door","jendela":"window","lampu":"lamp / light","komputer":"computer","hp":"phone / mobile",
  "mobil":"car","motor":"motorcycle","pesawat":"airplane","kapal":"ship","sepeda":"bicycle",
  "kucing":"cat","anjing":"dog","sapi":"cow","ayam":"chicken","ikan":"fish","burung":"bird",
  "apel":"apple","pisang":"banana","jeruk":"orange","mangga":"mango","nanas":"pineapple",
  "nasi":"rice","roti":"bread","sayur":"vegetable","buah":"fruit","daging":"meat",
  "merah":"red","biru":"blue","hijau":"green","kuning":"yellow","putih":"white","hitam":"black",
  "oranye":"orange","ungu":"purple","abu-abu":"gray","coklat":"brown","pink":"pink",
  "satu":"one","dua":"two","tiga":"three","empat":"four","lima":"five",
  "enam":"six","tujuh":"seven","delapan":"eight","sembilan":"nine","sepuluh":"ten",
  "seratus":"one hundred","seribu":"one thousand","juta":"million","miliar":"billion",
  "cinta":"love","rindu":"miss / longing","teman":"friend","sahabat":"best friend","keluarga":"family",
  "ayah":"father","ibu":"mother","kakak":"older sibling","adik":"younger sibling","kakek":"grandfather",
  "nenek":"grandmother","suami":"husband","istri":"wife","anak":"child","bayi":"baby",
  "negara":"country / nation","kota":"city / town","desa":"village","pulau":"island","gunung":"mountain",
  "sungai":"river","danau":"lake","laut":"sea / ocean","hutan":"forest","kebun":"garden / farm",
  "indonesia":"Indonesia","jakarta":"Jakarta","bali":"Bali","surabaya":"Surabaya","bandung":"Bandung",
  "dunia":"world","bumi":"Earth","alam semesta":"universe","langit":"sky","awan":"cloud",
  "harapan":"hope","impian":"dream","tujuan":"goal / aim","sukses":"success","gagal":"fail",
  "usaha":"effort / business","kerja keras":"hard work","semangat":"enthusiasm / spirit",
  "bahagia":"happy","damai":"peace","merdeka":"free / independent","bersama":"together",
  "indah":"beautiful","megah":"magnificent","luar biasa":"extraordinary / amazing",
  "hebat":"great / amazing","keren":"cool","mantap":"great (informal)","oke":"okay"
};
const DICT_EN_ID = Object.fromEntries(Object.entries(DICT_ID_EN).map(([k,v])=>[v.split(' / ')[0].toLowerCase(),k]));

// ================================================================
//  QUIZ BANK (50 soal)
// ================================================================
const QUIZ = [
  {q:"Ibu kota baru Indonesia?",o:["Jakarta","Nusantara","Surabaya","Palangkaraya"],a:1},
  {q:"Berapa planet di Tata Surya?",o:["7","8","9","10"],a:1},
  {q:"Siapa perumus Teori Relativitas?",o:["Newton","Darwin","Einstein","Hawking"],a:2},
  {q:"Proklamasi RI dibacakan tanggal?",o:["17 Agustus 1945","15 Agustus 1945","20 Agustus 1945","17 Juli 1945"],a:0},
  {q:"DNA singkatan dari?",o:["Deoxyribonucleic Acid","Double Nucleus Acid","Deoxynutrient Acid","Dynamic Neural Acid"],a:0},
  {q:"Kecepatan cahaya sekitar?",o:["150.000 km/s","300.000 km/s","500.000 km/s","3 juta km/s"],a:1},
  {q:"Gunung tertinggi di dunia?",o:["K2","Kangchenjunga","Everest","Lhotse"],a:2},
  {q:"Nilai Ï€ (Pi) â‰ˆ ?",o:["2,71828","3,14159","1,61803","1,41421"],a:1},
  {q:"Berapa tulang dalam tubuh manusia dewasa?",o:["186","196","206","216"],a:2},
  {q:"Simbol kimia untuk Besi adalah?",o:["Be","Fe","Bi","Fr"],a:1},
  {q:"Negara dengan populasi terbanyak 2024?",o:["India","China","USA","Indonesia"],a:0},
  {q:"Mahapatih Kerajaan Majapahit?",o:["Hayam Wuruk","Ken Arok","Gajah Mada","Raden Wijaya"],a:2},
  {q:"Suhu air mendidih pada tekanan normal?",o:["90Â°C","95Â°C","100Â°C","105Â°C"],a:2},
  {q:"Siapa penemu telepon?",o:["Edison","Tesla","Bell","Marconi"],a:2},
  {q:"Bahasa resmi PBB berjumlah?",o:["4","6","8","10"],a:1},
  {q:"Indonesia memiliki berberapa provinsi (2024)?",o:["34","36","38","40"],a:2},
  {q:"Proses tumbuhan membuat makanan?",o:["Respirasi","Fotosintesis","Transpirasi","Osmosis"],a:1},
  {q:"Batik diakui UNESCO tahun?",o:["2007","2008","2009","2010"],a:2},
  {q:"Rumus luas lingkaran?",o:["Ï€d","2Ï€r","Ï€rÂ²","Ï€r"],a:2},
  {q:"Presiden pertama Indonesia?",o:["Soeharto","Soekarno","Habibie","Megawati"],a:1},
  {q:"Gas terbanyak di atmosfer Bumi?",o:["Oksigen","COâ‚‚","Nitrogen","Argon"],a:2},
  {q:"Olimpiade modern pertama diadakan di?",o:["Paris","London","Athena","Roma"],a:2},
  {q:"Penemu World Wide Web?",o:["Steve Jobs","Bill Gates","Tim Berners-Lee","Linus Torvalds"],a:2},
  {q:"Vitamin C banyak di?",o:["Wortel","Jeruk","Pisang","Apel"],a:1},
  {q:"Angklung berasal dari daerah?",o:["Jawa","Bali","Sunda","Madura"],a:2},
  {q:"Bhinneka Tunggal Ika artinya?",o:["Berbeda tapi maju","Berbeda-beda tetap satu","Satu bangsa satu bahasa","Bersatu kita teguh"],a:1},
  {q:"Sumpah Pemuda tanggal?",o:["17 Agustus 1928","28 Oktober 1928","20 Mei 1908","1 Juni 1945"],a:1},
  {q:"Pulau terbesar di Indonesia?",o:["Jawa","Sulawesi","Kalimantan","Sumatera"],a:2},
  {q:"Rumus kecepatan (v)?",o:["v = m Ã— a","v = s / t","v = F / m","v = m Ã— g"],a:1},
  {q:"Agama terbesar di dunia (jumlah penganut)?",o:["Islam","Hindu","Kristen","Buddha"],a:2},
  {q:"Komponen utama CPU?",o:["ALU, CU, Register","RAM, ROM, Cache","BIOS, POST, UEFI","GPU, TPU, NPU"],a:0},
  {q:"Paus Biru adalah hewan terbesar?",o:["Di darat","Yang pernah ada","Di lautan saja","Di Asia"],a:1},
  {q:"Jumlah simfoni Beethoven?",o:["7","8","9","10"],a:2},
  {q:"Bahasa resmi ASEAN?",o:["Bahasa Inggris","Bahasa Melayu","Bahasa Indonesia","Tidak ada bahasa tunggal"],a:3},
  {q:"Tahun pertama manusia mendarat di Bulan?",o:["1965","1967","1969","1971"],a:2},
  {q:"E = mcÂ² dikemukakan oleh?",o:["Newton","Bohr","Einstein","Planck"],a:2},
  {q:"Rendang berasal dari daerah?",o:["Jawa","Minangkabau","Bali","Sulawesi"],a:1},
  {q:"Hukum Newton II: F = ?",o:["m/a","ma","m+a","m-a"],a:1},
  {q:"Danau terdalam di dunia?",o:["Danau Toba","Danau Superior","Lake Baikal","Danau Victoria"],a:2},
  {q:"Wayang Kulit diakui UNESCO tahun?",o:["2001","2003","2005","2007"],a:1},
  {q:"Palung terdalam di dunia?",o:["Palung Mariana","Palung Tonga","Palung Filipina","Palung Java"],a:0},
  {q:"Sel pertama kali ditemukan oleh?",o:["Darwin","Pasteur","Robert Hooke","Van Leeuwenhoek"],a:2},
  {q:"Kata 'robot' pertama kali digunakan dalam karya?",o:["I, Robot","Frankenstein","R.U.R","2001: A Space Odyssey"],a:2},
  {q:"Indonesia merdeka pada abad ke?",o:["XIX","XX","XXI","XVIII"],a:1},
  {q:"Hari Pendidikan Nasional Indonesia?",o:["28 Oktober","20 Mei","2 Mei","17 Agustus"],a:2},
  {q:"Candi Borobudur terletak di?",o:["Bali","Yogyakarta","Jawa Tengah","Jawa Timur"],a:2},
  {q:"Karbon dioksida terdiri dari?",o:["1C+1O","1C+2O","2C+1O","2C+2O"],a:1},
  {q:"Jumlah sisi segitiga?",o:["2","3","4","5"],a:1},
  {q:"Penulis 'Laskar Pelangi'?",o:["Pramoedya","Andrea Hirata","Habiburrahman","HAMKA"],a:1},
  {q:"Tekanan 1 Atmosfer = berapa Pa?",o:["10.000","100.000","101.325","1.000.000"],a:2},
];

// ================================================================
//  WORD GAME BANK
// ================================================================
const WORDS = [
  {w:"PANCASILA",h:"Dasar negara Indonesia"},
  {w:"MERDEKA",h:"Bebas dari penjajahan"},
  {w:"GARUDA",h:"Lambang negara Indonesia"},
  {w:"NUSANTARA",h:"Nama ibu kota baru + sebutan kepulauan Indonesia"},
  {w:"BOROBUDUR",h:"Candi Buddha terbesar di dunia"},
  {w:"KOMODO",h:"Hewan reptil raksasa dari Indonesia"},
  {w:"RENDANG",h:"Masakan khas Minangkabau, terlezat di dunia"},
  {w:"BATIK",h:"Kain tradisional warisan UNESCO"},
  {w:"GAMELAN",h:"Orkestra tradisional Jawa/Bali"},
  {w:"GAJAH",h:"Hewan darat terbesar"},
  {w:"SUMBER",h:"Asal atau tempat asalnya sesuatu"},
  {w:"ILMUWAN",h:"Orang yang mendalami ilmu pengetahuan"},
  {w:"MATEMATIKA",h:"Ilmu tentang angka dan perhitungan"},
  {w:"SEJARAH",h:"Catatan peristiwa masa lampau"},
  {w:"KRAKATAU",h:"Gunung berapi terkenal di Selat Sunda"},
  {w:"SEMANGAT",h:"Dorongan/gairah dalam melakukan sesuatu"},
  {w:"KALIMANTAN",h:"Pulau terbesar ketiga di dunia"},
  {w:"FOTOSINTESIS",h:"Proses tumbuhan membuat makanan"},
  {w:"OLIMPIADE",h:"Pesta olahraga internasional 4 tahunan"},
  {w:"DEMOKRASI",h:"Sistem pemerintahan dari rakyat, oleh rakyat"},
];

// ================================================================
//  RECIPES
// ================================================================
const RECIPES = {
  "nasi goreng":{
    name:"ğŸ³ Nasi Goreng Spesial",
    bahan:["2 piring nasi putih (dingin)","2 butir telur","3 siung bawang putih","2 siung bawang merah","2 sdm kecap manis","1 sdm saus tiram","garam, merica, penyedap","minyak goreng secukupnya","Topping: acar, kerupuk, bawang goreng"],
    cara:["Panaskan minyak, tumis bawang merah & putih hingga harum","Kocok telur, masukkan ke wajan, orak-arik setengah matang","Masukkan nasi, aduk merata dengan bahan lain","Beri kecap manis, saus tiram, garam, merica","Aduk hingga nasi berwarna coklat keemasan","Sajikan dengan topping kesukaan"]
  },
  "rendang":{
    name:"ğŸ¥˜ Rendang Sapi Asli",
    bahan:["1 kg daging sapi, potong dadu 4cm","1 liter santan kental","Bumbu halus: 15 cabe merah, 8 bawang merah, 6 bawang putih, 3cm jahe, 3cm lengkuas, 2cm kunyit, serai 2 batang","Daun: 4 daun jeruk, 2 daun salam, 1 batang serai geprek","Garam dan gula merah secukupnya"],
    cara:["Masak santan + bumbu halus + rempah hingga mendidih","Masukkan daging, masak api sedang","Aduk sesekali hingga santan menyusut","Kecilkan api, terus masak sambil diaduk","Masak 3-4 jam hingga bumbu meresap & kering","Angkat saat warna coklat kehitaman"]
  },
  "soto ayam":{
    name:"ğŸ² Soto Ayam Bening",
    bahan:["1 ekor ayam kampung","2L air","Bumbu: 5 bawang merah, 4 bawang putih, 3cm jahe, 2cm kunyit, 3 kemiri","Rempah: 2 serai, 3 daun salam, 3 daun jeruk","Garam dan merica secukupnya","Pelengkap: soun, telur rebus, tomat, daun bawang, jeruk nipis"],
    cara:["Rebus ayam dengan air dan rempah hingga matang","Angkat ayam, suwir-suwir","Tumis bumbu halus, masukkan ke kaldu","Didihkan, cicipi rasa","Sajikan dengan soun, suwiran ayam","Tambahkan pelengkap dan perasan jeruk nipis"]
  },
  "gado-gado":{
    name:"ğŸ¥— Gado-Gado Jakarta",
    bahan:["Sayuran: kangkung, tauge, kentang, wortel, kol rebus","Tahu goreng, tempe goreng, telur rebus","Saus kacang: 200g kacang tanah goreng, 3 cabe merah, 3 bawang putih, 1 sdm kecap, air secukupnya, garam & gula"],
    cara:["Rebus sayuran hingga matang, tiriskan","Goreng tahu dan tempe hingga keemasan","Rebus telur, potong dua","Haluskan kacang + bumbu saus kacang","Cairkan dengan air, masak sebentar","Susun sayuran, tuang saus kacang, sajikan dengan kerupuk"]
  },
  "mie goreng":{
    name:"ğŸœ Mie Goreng Jawa",
    bahan:["200g mie kuning basah","100g ayam suwir / udang","2 butir telur","Bumbu: 4 bawang merah, 3 bawang putih, 1 sdm kecap manis, saus tiram","Sayuran: sawi, wortel, tauge","Minyak goreng, garam, merica"],
    cara:["Rebus mie sebentar, tiriskan","Tumis bawang merah & putih hingga harum","Masukkan ayam/udang, masak matang","Orak-arik telur di pinggir wajan","Masukkan mie, aduk dengan bumbu & kecap","Tambahkan sayuran, aduk merata, sajikan"]
  },
  "pempek":{
    name:"ğŸ«“ Pempek Palembang",
    bahan:["500g ikan tenggiri haluskan","150g tepung sagu","1 sdm garam, air secukupnya","Cuko: 500ml air, 200g gula merah, 50ml cuka, 10 cabe rawit, bawang putih"],
    cara:["Campur ikan halus + tepung sagu + garam","Uleni hingga kalis, bentuk sesuai selera","Rebus dalam air mendidih hingga mengapung","Angkat, goreng hingga keemasan","Buat cuko: rebus semua bahan hingga kental","Sajikan pempek dengan cuko"]
  },
  "bakso":{
    name:"ğŸ¥£ Bakso Sapi Kenyal",
    bahan:["500g daging sapi giling halus","3 sdm tepung sagu","1 butir putih telur","3 siung bawang putih halus","Garam, merica, penyedap","Kaldu: tulang sapi, bawang putih, merica"],
    cara:["Campur daging + tepung + putih telur + bumbu","Uleni hingga kalis dan elastis","Bulatkan menggunakan tangan + sendok","Masukkan ke air mendidih hingga mengapung","Buat kaldu dari tulang sapi yang direbus lama","Sajikan bakso dalam kaldu + mie, tahu, bawang goreng"]
  },
  "martabak":{
    name:"ğŸ¥ Martabak Manis Tebal",
    bahan:["250g tepung terigu","1 butir telur","250ml susu cair","1/2 sdt ragi instan","2 sdm gula, 1/4 sdt garam","Topping: keju parut, coklat meses, susu kental manis"],
    cara:["Campur tepung, gula, ragi, telur, susu","Aduk rata hingga adonan licin","Diamkan 1 jam hingga berbuih","Panaskan cetakan martabak, tuang adonan","Tutup, masak hingga berlubang di permukaan","Taburi topping, lipat, potong, sajikan hangat"]
  }
};

// ================================================================
//  CONVERTER
// ================================================================
const CONV = {
  suhu:{
    label:"Suhu",pairs:[
      {from:"Celsius",to:"Fahrenheit",fn:v=>v*9/5+32},
      {from:"Fahrenheit",to:"Celsius",fn:v=>(v-32)*5/9},
      {from:"Celsius",to:"Kelvin",fn:v=>v+273.15},
      {from:"Kelvin",to:"Celsius",fn:v=>v-273.15},
    ]},
  panjang:{
    label:"Panjang",pairs:[
      {from:"Meter",to:"Kilometer",fn:v=>v/1000},
      {from:"Kilometer",to:"Meter",fn:v=>v*1000},
      {from:"Meter",to:"Kaki (feet)",fn:v=>v*3.28084},
      {from:"Kaki",to:"Meter",fn:v=>v/3.28084},
      {from:"Meter",to:"Inci (inch)",fn:v=>v*39.3701},
      {from:"Mil",to:"Kilometer",fn:v=>v*1.60934},
    ]},
  berat:{
    label:"Berat/Massa",pairs:[
      {from:"Kilogram",to:"Gram",fn:v=>v*1000},
      {from:"Gram",to:"Kilogram",fn:v=>v/1000},
      {from:"Kilogram",to:"Pound",fn:v=>v*2.20462},
      {from:"Pound",to:"Kilogram",fn:v=>v/2.20462},
      {from:"Ton",to:"Kilogram",fn:v=>v*1000},
    ]},
  waktu:{
    label:"Waktu",pairs:[
      {from:"Jam",to:"Menit",fn:v=>v*60},
      {from:"Menit",to:"Detik",fn:v=>v*60},
      {from:"Hari",to:"Jam",fn:v=>v*24},
      {from:"Minggu",to:"Hari",fn:v=>v*7},
      {from:"Tahun",to:"Hari",fn:v=>v*365},
    ]},
  kecepatan:{
    label:"Kecepatan",pairs:[
      {from:"m/s",to:"km/jam",fn:v=>v*3.6},
      {from:"km/jam",to:"m/s",fn:v=>v/3.6},
      {from:"Knot",to:"km/jam",fn:v=>v*1.852},
      {from:"mph",to:"km/jam",fn:v=>v*1.60934},
    ]},
};

// ================================================================
//  KNOWLEDGE BASE (expanded)
// ================================================================
const KB = {
sains:[
  {q:["kecerdasan buatan","ai","machine learning","deep learning","neural network"],
  a:`ğŸ¤– **Kecerdasan Buatan (AI)** â€” Otak Komputer Modern\n\n**Hierarki AI:**\nâ€¢ AI â†’ Machine Learning â†’ Deep Learning â†’ Neural Network\n\n**Jenis ML:**\nâ€¢ **Supervised** â€” belajar dari data berlabel (klasifikasi, regresi)\nâ€¢ **Unsupervised** â€” temukan pola sendiri (clustering)\nâ€¢ **Reinforcement** â€” belajar dari reward/penalty (AlphaGo, robot)\n\n**Arsitektur Deep Learning:**\nâ€¢ CNN â€” pengenalan gambar\nâ€¢ RNN/LSTM â€” urutan & bahasa\nâ€¢ Transformer â€” ChatGPT, BERT, LLM\nâ€¢ GAN â€” buat gambar sintetis\n\n**Aplikasi Nyata:**\nDiagnosis kanker, mobil otonom, ChatGPT, AlphaFold (protein), DALL-E, GitHub Copilot\n\n**Tantangan AI:**\nHalusinasi, bias data, konsumsi energi besar, keamanan, etika ğŸ›¡ï¸`},
  {q:["atom","proton","neutron","elektron","fisika atom","partikel"],
  a:`âš›ï¸ **Atom & Partikel Subatom**\n\n**Model Atom Modern:**\nIni bukan orbit pasti (seperti Bohr), tapi orbital probabilistik (awan elektron)\n\n**Partikel dasar:**\nâ€¢ Quark â†’ proton & neutron\nâ€¢ Elektron â†’ leptonik\nâ€¢ Foton â†’ pembawa gaya elektromagnetik\nâ€¢ Gluon â†’ pembawa gaya kuat (ikat inti)\n\n**4 Gaya Fundamental:**\n1. Gravitasi â€” paling lemah, jangkauan tak terbatas\n2. Elektromagnetik â€” cahaya, magnet, kimia\n3. Gaya Kuat â€” ikat inti atom\n4. Gaya Lemah â€” peluruhan radioaktif\n\n**Antimateri:** Setiap partikel punya antipartikel. Saat bertemu â†’ musnah jadi energi (E=mcÂ²)\n\n**Fun fact:** 99,9999% atom adalah ruang kosong! Jika proton sebesar bola sepak, elektronnya berputar 10 km jauhnya! âš›ï¸`},
  {q:["relativitas","einstein","e=mc2","ruang waktu","gravitasi umum"],
  a:`ğŸŒŒ **Teori Relativitas Einstein â€” Lengkap**\n\n**Relativitas Khusus (1905):**\nâ€¢ Postulat 1: Hukum fisika sama di semua kerangka inersia\nâ€¢ Postulat 2: Kecepatan cahaya = konstan (c â‰ˆ 3Ã—10â¸ m/s)\nâ€¢ **Dilasi waktu:** t' = t/âˆš(1-vÂ²/cÂ²)\nâ€¢ **Kontraksi panjang:** L' = LÃ—âˆš(1-vÂ²/cÂ²)\nâ€¢ **E = mcÂ²** â€” massa adalah energi yang "tersimpan"\n\n**Relativitas Umum (1915):**\nâ€¢ Massa melengkungkan ruang-waktu\nâ€¢ Gravitasi = geometri ruang-waktu\nâ€¢ Prediksi: lubang hitam, gelombang gravitasi, lubang cacing\n\n**Dampak dalam Kehidupan:**\nâ€¢ GPS koreksi 38 mikrodetik/hari (tanpanya, GPS meleset 10 km/hari!)\nâ€¢ Bom atom (E=mcÂ²)\nâ€¢ Memahami lubang hitam\n\n**LIGO 2015:** Deteksi pertama gelombang gravitasi! ğŸŒŠ`},
  {q:["dna","genetika","gen","kromosom","evolusi","hereditas"],
  a:`ğŸ§¬ **DNA, Gen & Genetika Modern**\n\n**Central Dogma:**\nDNA â†’ (Transkripsi) â†’ mRNA â†’ (Translasi) â†’ Protein\n\n**Ekspresi Gen:**\nâ€¢ Tidak semua gen selalu "nyala" â€” ada epigenetik\nâ€¢ Faktor lingkungan memengaruhi ekspresi gen\n\n**CRISPR-Cas9 (2012):**\nAlat edit gen presisi tinggi. Bisa matikan gen penyakit, potensi sembuhkan:\nâ€¢ Sel sabit, kanker, buta bawaan, HIV\nâ€¢ Etika: "desainer bayi" jadi perdebatan!\n\n**Evolusi Darwin:**\nâ€¢ Variasi â†’ Seleksi alam â†’ Adaptasi â†’ Spesiasi\nâ€¢ Bukti: fosil, DNA komparatif, embriologi\n\n**Fakta Mengejutkan:**\nâ€¢ ~60% gen manusia ada di lalat buah!\nâ€¢ Gen jumping (transposon) = 45% DNA manusia\nâ€¢ Hanya 1,5% DNA manusia yang kode protein. 98,5%? Masih dipelajari! ğŸ”¬`},
  {q:["fotosintesis","respirasi","biologi","sel","metabolisme"],
  a:`ğŸŒ¿ **Biologi Sel & Metabolisme**\n\n**Fotosintesis:**\n6COâ‚‚ + 6Hâ‚‚O + cahaya â†’ Câ‚†Hâ‚â‚‚Oâ‚† + 6Oâ‚‚\nTerjadi di kloroplas (grana & stroma)\n\n**Respirasi Sel (kebalikan fotosintesis):**\nCâ‚†Hâ‚â‚‚Oâ‚† + 6Oâ‚‚ â†’ 6COâ‚‚ + 6Hâ‚‚O + ATP\nTerjadi di mitokondria (matriks & membran krista)\n\n**Struktur Sel:**\nâ€¢ Membran plasma (fosfolipid bilayer)\nâ€¢ Nukleus (DNA, nukleolus)\nâ€¢ Ribosom (sintesis protein)\nâ€¢ Mitokondria (produksi ATP)\nâ€¢ ER kasar/halus, aparatus Golgi, lisosom\n\n**Perbedaan Sel Prokariot vs Eukariot:**\n| Prokariot | Eukariot |\n|-----------|----------|\n|Tidak punya inti|Punya inti|nol membran|ada membran|Bakteri|Hewan,tumbuhan,jamur|\n\n**ATP:** Mata uang energi sel. 1 glukosa = 36-38 ATP ğŸ”‹`},
],

teknologi:[
  {q:["python","pemrograman","coding","belajar kode"],
  a:`ğŸ **Python â€” Bahasa Paling Populer di Dunia!**\n\n**Kenapa Python?**\nâ€¢ Sintaks bersih & mudah baca\nâ€¢ Serbaguna: AI/ML, web, data, otomasi, game\nâ€¢ Ekosistem library terlengkap\n\n**Konsep Fundamental:**\n\`\`\`python\n# Data Types\nx = 42          # int\ny = 3.14        # float\nz = "Halo!"     # str\na = [1,2,3]     # list (mutable)\nb = (1,2,3)     # tuple (immutable)\nc = {'k':'v'}   # dict\nd = {1,2,3}     # set\n\n# List Comprehension\nkuadrat = [x**2 for x in range(10)]\n\n# Lambda & map\ndouble = lambda x: x*2\nresult = list(map(double, [1,2,3,4]))\n\n# Class OOP\nclass Hewan:\n    def __init__(self, nama):\n        self.nama = nama\n    def suara(self): pass\n\nclass Kucing(Hewan):\n    def suara(self): return "Meow!"\n\`\`\`\n\n**Roadmap Belajar:**\nBasic â†’ OOP â†’ File I/O â†’ Library (NumPy, Pandas) â†’ Web (Flask/Django) â†’ ML (sklearn, TF) ğŸš€`},
  {q:["javascript","html","css","react","vue","web development","frontend","backend"],
  a:`ğŸŒ **Web Development Modern 2024**\n\n**Frontend Stack Populer:**\nâ€¢ React.js (Meta) â€” komponen, hooks, virtual DOM\nâ€¢ Vue.js â€” progressif, mudah dipelajari\nâ€¢ Next.js â€” SSR/SSG, full-stack React\nâ€¢ Svelte â€” compile-time, super cepat\n\n**CSS Modern:**\n\`\`\`css\n/* Flexbox */\n.container { display: flex; gap: 16px; }\n\n/* Grid */\n.grid { display: grid; grid-template-columns: repeat(3, 1fr); }\n\n/* CSS Variables */\n:root { --primary: #60a5fa; }\n.btn { background: var(--primary); }\n\n/* Container Queries (2023) */\n@container (min-width: 700px) { .card { flex-direction: row; } }\n\`\`\`\n\n**JS Modern (ES2024):**\n\`\`\`javascript\n// Optional chaining\nconst city = user?.address?.city ?? 'Unknown';\n\n// Promise.allSettled\nconst results = await Promise.allSettled([fetch1, fetch2]);\n\n// Top-level await (modules)\nconst data = await fetchData();\n\`\`\`\n\n**Backend:** Node.js/Express, Django, Laravel, Spring Boot, Go Fiber ğŸ—ï¸`},
  {q:["algoritma","data structure","binary","sorting","graph","tree","kompleksitas"],
  a:`ğŸ”„ **Algoritma & Struktur Data â€” Foundation CS**\n\n**Binary Search Tree (BST):**\nInsert, Search, Delete: O(log n) average, O(n) worst\n\n**Graph Algorithms:**\nâ€¢ BFS â€” level-by-level, shortest path (unweighted)\nâ€¢ DFS â€” depth-first, cycle detection\nâ€¢ Dijkstra â€” shortest path (weighted)\nâ€¢ A* â€” heuristic-based, AI pathfinding\n\n**Dynamic Programming:**\nMemoization (top-down) vs Tabulation (bottom-up)\nContoh: Fibonacci, Knapsack, LCS\n\n**Sorting Kompleksitas:**\n| Algoritma | Best | Avg | Worst | Space |\n|-----------|------|-----|-------|-------|\n| Quick Sort|O(n log n)|O(n log n)|O(nÂ²)|O(log n)|\n| Merge Sort|O(n log n)|O(n log n)|O(n log n)|O(n)|\n| Heap Sort|O(n log n)|O(n log n)|O(n log n)|O(1)|\n| Counting|O(n+k)|O(n+k)|O(n+k)|O(k)|\n\n**Hash Table:**\nOpen addressing vs Chaining\nLoad factor â†’ resize jika > 0.75 ğŸ“Š`},
  {q:["cybersecurity","keamanan","enkripsi","hacking","network","firewall"],
  a:`ğŸ”’ **Cybersecurity â€” Lindungi Dirimu di Dunia Digital**\n\n**Top 10 OWASP 2024:**\n1. Broken Access Control\n2. Cryptographic Failures\n3. Injection (SQL, XSS)\n4. Insecure Design\n5. Security Misconfiguration\n\n**Teknik Serangan:**\nâ€¢ **Phishing** â€” email/situs palsu\nâ€¢ **Brute Force** â€” coba semua kombinasi\nâ€¢ **MITM** â€” sadap komunikasi\nâ€¢ **DDoS** â€” banjiri server dengan traffic\nâ€¢ **Zero-day** â€” exploit sebelum patch\n\n**Kriptografi:**\nâ€¢ RSA â€” asimetris, 2048-4096 bit\nâ€¢ AES-256 â€” simetris, sangat cepat\nâ€¢ TLS 1.3 â€” HTTPS modern\nâ€¢ SHA-256 â€” hash function (Bitcoin!)\n\n**Tips Aman:**\nâœ… Password manager (Bitwarden, 1Password)\nâœ… 2FA dengan TOTP (bukan SMS)\nâœ… Update sistem otomatis\nâœ… Backup 3-2-1 (3 salinan, 2 media, 1 offline)\nâœ… VPN di WiFi publik ğŸ›¡ï¸`},
  {q:["cloud","aws","azure","docker","kubernetes","devops","microservices"],
  a:`â˜ï¸ **Cloud Computing & DevOps Modern**\n\n**3 Model Layanan:**\nâ€¢ **IaaS** â€” VM, storage (AWS EC2, Azure VM)\nâ€¢ **PaaS** â€” runtime, middleware (Heroku, App Engine)\nâ€¢ **SaaS** â€” aplikasi siap pakai (Gmail, Salesforce)\n\n**Docker Dasar:**\n\`\`\`dockerfile\nFROM python:3.11-slim\nWORKDIR /app\nCOPY requirements.txt .\nRUN pip install -r requirements.txt\nCOPY . .\nCMD ["python", "app.py"]\n\`\`\`\n\n**Kubernetes (K8s):**\nâ€¢ Pod â†’ Deployment â†’ Service â†’ Ingress\nâ€¢ Auto-scaling, self-healing, rolling updates\n\n**CI/CD Pipeline:**\nCode â†’ Test â†’ Build â†’ Deploy\nTools: GitHub Actions, Jenkins, GitLab CI\n\n**Top Cloud 2024:**\nğŸ¥‡ AWS (32% market share)\nğŸ¥ˆ Azure (22%)\nğŸ¥‰ Google Cloud (12%) â˜ï¸`},
],

sejarah:[
  {q:["kemerdekaan","proklamasi","soekarno","indonesia merdeka","17 agustus","1945"],
  a:`ğŸ‡®ğŸ‡© **Proklamasi Kemerdekaan RI â€” 17 Agustus 1945**\n\n**Latar Belakang:**\nJepang menyerah ke Sekutu setelah bom atom Hiroshima (6 Agt) & Nagasaki (9 Agt 1945)\n\n**Timeline Kritis:**\nâ€¢ **14 Agt** â€” Jepang umumkan kekalahan\nâ€¢ **15 Agt** â€” Pemuda desak proklamasi segera\nâ€¢ **Malam 15-16 Agt** â€” Sukarno-Hatta dibawa ke Rengasdengklok\nâ€¢ **Malam 16 Agt** â€” Perumusan naskah di rumah Laksamana Maeda, Jakarta\nâ€¢ **17 Agt, 10.00 WIB** â€” Proklamasi! ğŸ‰\n\n**Teks Proklamasi:**\nDitulis tangan Sukarno, dikoreksi bersama Hatta & Ahmad Soebardjo\nDiketik Sayuti Melik, ditandatangani "atas nama bangsa Indonesia"\n\n**Tokoh-Tokoh:**\nâ€¢ Pengibar bendera: Latief Hendraningrat & Soehoed\nâ€¢ Bendera dijahit: Fatmawati\nâ€¢ Penyiar: Frederick Sutherland (radio)\n\n**Dampak:** Lahirnya NKRI, negara merdeka ke-73 di dunia saat itu ğŸŒŸ`},
  {q:["majapahit","gajah mada","sumpah palapa","nusantara","hayam wuruk","trowulan"],
  a:`ğŸ‘‘ **Kerajaan Majapahit â€” Puncak Kejayaan Nusantara**\n\n**Berdirinya (1293 M):**\nRaden Wijaya, menantu Raja Singasari, mendirikan Majapahit setelah mengalahkan pasukan Mongol dengan taktik cerdik!\n\n**Masa Keemasan (1350-1389):**\nRaja Hayam Wuruk + Mahapatih Gajah Mada\n\n**Sumpah Palapa (1336):**\n*"Amukti palapa, lamun huwus kalah Nusantara isun amukti palapa"*\nGajah Mada bersumpah tidak menikmati rempah-rempah sebelum Nusantara bersatu!\n\n**Wilayah Kekuasaan:**\nJawa, Bali, Lombok, Sumbawa, Flores, Timor, Maluku, Sulawesi, Kalimantan, Sumatera, Semenanjung Malaya, sebagian Filipina\n\n**Warisan Abadi:**\nğŸ“œ Negarakertagama (Mpu Prapanca, 1365)\nğŸ“œ Sutasoma â€” "Bhinneka Tunggal Ika" (Mpu Tantular)\nğŸ“Œ Nama "Nusantara" untuk ibu kota baru Indonesia!\n\n**Keruntuhan:** ~1527 M akibat perang saudara & masuknya Islam ğŸ›ï¸`},
  {q:["perang dunia","ww2","ww1","nazi","holocaust","hiroshima","nagasaki","sekutu"],
  a:`âš”ï¸ **Perang Dunia II (1939-1945) â€” Konflik Terbesar Sejarah**\n\n**Penyebab:**\nâ€¢ Perjanjian Versailles yang menyengsarakan Jerman\nâ€¢ Kebangkitan fasisme (Hitler, Mussolini, Tojo)\nâ€¢ Kebijakan appeasement yang gagal\n\n**Blok Bertarung:**\nâ€¢ Sekutu: AS, Inggris, USSR, Prancis, China\nâ€¢ Poros: Jerman, Italia, Jepang\n\n**Titik Balik:**\nğŸ“… 1940 â€” Battle of Britain (gagal invasi Jerman ke Inggris)\nğŸ“… 1941 â€” Pearl Harbor â†’ AS masuk perang\nğŸ“… 1942-43 â€” Stalingrad â†’ balikan front Timur\nğŸ“… 6 Juni 1944 â€” D-Day Normandy\nğŸ“… 30 April 1945 â€” Hitler bunuh diri\nğŸ“… 6 & 9 Agustus 1945 â€” Hiroshima & Nagasaki\n\n**Korban:** ~70-85 juta jiwa (3% populasi dunia)\n**Holocaust:** 6 juta Yahudi dimusnahkan\n\n**Dampak:** PBB dibentuk, Perang Dingin mulai, dekolonisasi besar ğŸŒ`},
  {q:["sumpah pemuda","28 oktober","pergerakan nasional","boedi oetomo","kebangkitan nasional"],
  a:`ğŸ‡®ğŸ‡© **Sumpah Pemuda & Kebangkitan Nasional**\n\n**Boedi Oetomo (20 Mei 1908):**\nOrganisasi modern pertama â†’ Hari Kebangkitan Nasional\n\n**Kongres Pemuda II â€” 28 Oktober 1928:**\n\nTiga ikrar bersejarah:\n1. Satu Tanah Air â€” Indonesia\n2. Satu Bangsa â€” Bangsa Indonesia\n3. Satu Bahasa Persatuan â€” Bahasa Indonesia\n\n**Tokoh Penggerak:**\nâ€¢ Muhammad Yamin â€” konseptor\nâ€¢ Sugondo Djojopuspito â€” ketua kongres\nâ€¢ W.R. Soepratman â€” mainkan Indonesia Raya untuk pertama kali!\n\n**Lokasi:** Jl. Kramat Raya 106, Jakarta Pusat (kini Museum Sumpah Pemuda)\n\n**Makna Mendalam:**\nPemuda dari Jawa, Sumatera, Sulawesi, Kalimantan, dll â€” melampaui batas suku & agama untuk satu identitas: INDONESIA\n\nğŸ“… 28 Oktober = Hari Sumpah Pemuda & Hari Bahasa Indonesia! ğŸŒº`},
  {q:["reformasi 1998","soeharto","orde baru","demokrasi indonesia","gus dur","habibie","megawati"],
  a:`ğŸ›ï¸ **Reformasi 1998 â€” Babak Baru Indonesia**\n\n**Latar Belakang:**\nâ€¢ Krisis moneter Asia 1997-1998 (rupiah jatuh dari Rp2.500 â†’ Rp17.000/USD)\nâ€¢ Korupsi, kolusi, nepotisme Orde Baru\nâ€¢ Inflasi 80%, pengangguran melonjak\n\n**Peristiwa Kunci:**\nâ€¢ Mahasiswa turun ke jalan besar-besaran\nâ€¢ Tragedi Trisakti (12 Mei 1998) â€” 4 mahasiswa tewas\nâ€¢ Kerusuhan Mei 1998\nâ€¢ 21 Mei 1998 â€” Soeharto mundur setelah 32 tahun berkuasa!\n\n**Era Reformasi:**\nâ€¢ Habibie (1998-1999) â€” reformasi awal, referendum Timor Timur\nâ€¢ Abdurrahman Wahid/Gus Dur (1999-2001) â€” demokratisasi\nâ€¢ Megawati (2001-2004) â€” stabilisasi\nâ€¢ SBY (2004-2014) â€” pemilu langsung pertama\nâ€¢ Jokowi (2014-2024) â€” pembangunan infrastruktur\nâ€¢ Prabowo (2024-) â€” presiden ke-8\n\n**Warisan Reformasi:** Kebebasan pers, otonomi daerah, pemilu langsung ğŸ—³ï¸`},
],

matematika:[
  {q:["kalkulus","turunan","integral","limit","diferensial"],
  a:`âˆ« **Kalkulus â€” Bahasa Alam Semesta**\n\n**Limit:**\nlim_{xâ†’a} f(x) = L\nâ€¢ L'HÃ´pital: jika 0/0 atau âˆ/âˆ â†’ diferensialkan pembilang & penyebut\n\n**Turunan (Diferensial):**\nAturan dasar:\nâ€¢ d/dx[xâ¿] = nxâ¿â»Â¹\nâ€¢ d/dx[eË£] = eË£\nâ€¢ d/dx[ln x] = 1/x\nâ€¢ d/dx[sin x] = cos x, d/dx[cos x] = -sin x\nâ€¢ d/dx[tan x] = secÂ²x\n\nAturan rantai: d/dx[f(g(x))] = f'(g(x))Â·g'(x)\nAturan produk: d/dx[uv] = u'v + uv'\nAturan quotient: d/dx[u/v] = (u'v - uv')/vÂ²\n\n**Integral:**\nâ€¢ âˆ«xâ¿ dx = xâ¿âºÂ¹/(n+1) + C\nâ€¢ âˆ«eË£ dx = eË£ + C\nâ€¢ âˆ«(1/x) dx = ln|x| + C\nâ€¢ âˆ«sin x dx = -cos x + C\n\n**FTC:** âˆ«_a^b f(x)dx = F(b) - F(a)\n\n**Aplikasi:** fisika, ekonomi, statistik, ML gradient descent! ğŸ“ˆ`},
  {q:["trigonometri","sin cos tan","sudut","segitiga siku-siku","identitas trigonometri"],
  a:`ğŸ“ **Trigonometri Lengkap**\n\n**Rasio Dasar (SOH-CAH-TOA):**\nâ€¢ sin Î¸ = sisi depan / hipotenusa\nâ€¢ cos Î¸ = sisi samping / hipotenusa\nâ€¢ tan Î¸ = sisi depan / sisi samping = sin/cos\n\n**Nilai Istimewa:**\n|  Î¸  | sin | cos | tan |\n|-----|-----|-----|-----|\n| 0Â°  |  0  |  1  |  0  |\n| 30Â° | Â½   |Â½âˆš3  |â…“âˆš3  |\n| 45Â° | Â½âˆš2 | Â½âˆš2 |  1  |\n| 60Â° | Â½âˆš3 |  Â½  |  âˆš3 |\n| 90Â° |  1  |  0  |  âˆ  |\n\n**Identitas Penting:**\nâ€¢ sinÂ²Î¸ + cosÂ²Î¸ = 1\nâ€¢ 1 + tanÂ²Î¸ = secÂ²Î¸\nâ€¢ sin(AÂ±B) = sinA cosB Â± cosA sinB\nâ€¢ cos(AÂ±B) = cosA cosB âˆ“ sinA sinB\nâ€¢ sin(2Î¸) = 2sinÎ¸cosÎ¸\nâ€¢ cos(2Î¸) = cosÂ²Î¸ - sinÂ²Î¸\n\n**Aturan Sinus & Cosinus:**\na/sinA = b/sinB = c/sinC\ncÂ² = aÂ² + bÂ² - 2abÂ·cosC ğŸ”º`},
  {q:["statistik","probabilitas","distribusi","regresi","inferensi","hipotesis"],
  a:`ğŸ“Š **Statistika & Inferensi**\n\n**Distribusi Penting:**\nâ€¢ Normal N(Î¼,ÏƒÂ²) â€” bell curve, simetris\nâ€¢ Binomial B(n,p) â€” percobaan diskrit\nâ€¢ Poisson P(Î») â€” kejadian langka\nâ€¢ T-Student â€” sampel kecil, Ïƒ tidak diketahui\n\n**Inferensi Statistik:**\nâ€¢ **Uji Hipotesis:** Hâ‚€ vs Hâ‚\nâ€¢ p-value < Î± (0.05) â†’ tolak Hâ‚€\nâ€¢ Interval Kepercayaan: xÌ„ Â± zÂ·(Ïƒ/âˆšn)\n\n**Regresi Linier:** y = Î²â‚€ + Î²â‚x + Îµ\nâ€¢ Least squares: minimumkan Î£(yi - Å·i)Â²\nâ€¢ RÂ² = seberapa baik model fit (0-1)\n\n**Korelasi Pearson:** r âˆˆ [-1, 1]\nâ€¢ r = 1: korelasi positif sempurna\nâ€¢ r = 0: tidak ada korelasi linier\nâ€¢ r = -1: korelasi negatif sempurna\n\n**Hati-hati:** Korelasi â‰  Kausalitas!\n"Konsumsi es krim naik â†’ tenggelam naik" (keduanya karena panas!) ğŸ˜„`},
  {q:["vektor","matriks","aljabar linear","determinan","transformasi"],
  a:`ğŸ”¢ **Aljabar Linear**\n\n**Vektor:**\nâ€¢ Skalar (besaran) vs Vektor (besaran + arah)\nâ€¢ Operasi: penjumlahan, perkalian skalar, dot product, cross product\nâ€¢ Dot product: aÂ·b = |a||b|cosÎ¸\nâ€¢ Cross product: aÃ—b = vektor tegak lurus\n\n**Matriks:**\nOperasi: penjumlahan, perkalian, transpose, invers\n\n**Determinan (2Ã—2):**\n|a b|\n|c d| = ad - bc\n\n**Invers Matriks:**\nAâ»Â¹ = (1/det A) Ã— adjugate(A)\n\n**Transformasi Linier:**\nâ€¢ Rotasi, refleksi, dilatasi, shear\nâ€¢ Semua bisa direpresentasikan sebagai matriks!\n\n**Eigenvalue & Eigenvector:**\nAv = Î»v\nFundamental dalam: PCA (data science), vibrasi mekanik, PageRank Google!\n\n**Aplikasi:** Computer graphics, ML, fisika, ekonomi, rekayasa ğŸ¯`},
],

bahasa:[
  {q:["bahasa indonesia","ejaan","tata bahasa","kalimat","kata","morfologi"],
  a:`ğŸ“– **Bahasa Indonesia â€” Sistem Lengkap**\n\n**Morfologi (Pembentukan Kata):**\nâ€¢ **Afiksasi:** me-, ber-, ter-, pe-, -an, -kan, -i\nâ€¢ **Reduplikasi:** buku-buku, berlari-lari\nâ€¢ **Komposisi:** rumah sakit, meja makan\nâ€¢ **Abreviasi:** KBBI, TNI, PR\n\n**Konfiks Penting:**\nâ€¢ me-kan: mempermasalahkan â†’ causative\nâ€¢ ke-an: kebaikan â†’ kondisi/abstrak\nâ€¢ pe-an: pembelajaran â†’ proses\nâ€¢ per-an: perjalanan â†’ hasil\n\n**Jenis Kata (Kelas Kata):**\nâ€¢ Nomina (kata benda): rumah, kebaikan\nâ€¢ Verba (kata kerja): berlari, makan\nâ€¢ Adjektiva (kata sifat): cantik, besar\nâ€¢ Adverbia (kata keterangan): sangat, sudah\nâ€¢ Konjungsi: dan, atau, tetapi, karena\nâ€¢ Preposisi: di, ke, dari, untuk\n\n**Kaidah PUEBI 2015:**\nâ€¢ Penulisan gabungan kata: nonstop, antarbangsa\nâ€¢ Huruf kapital: awal kalimat, nama diri\nâ€¢ Tanda baca: koma, titik, titik dua ğŸ“`},
  {q:["bahasa inggris","grammar","tenses","vocabulary","speaking","ielts","toefl"],
  a:`ğŸ‡¬ğŸ‡§ **Bahasa Inggris â€” Panduan Lengkap**\n\n**Tenses 12 Utama:**\n\n| Tense | Formula | Contoh |\n|-------|---------|--------|\n| Simple Present | S + V1/es | I eat |\n| Pres. Continuous | S + am/is/are + Ving | I am eating |\n| Pres. Perfect | S + have/has + V3 | I have eaten |\n| Simple Past | S + V2 | I ate |\n| Past Continuous | S + was/were + Ving | I was eating |\n| Past Perfect | S + had + V3 | I had eaten |\n| Simple Future | S + will + V1 | I will eat |\n| Future Perfect | S + will have + V3 | I will have eaten |\n\n**Passive Voice:**\nAktif: She reads the book.\nPasif: The book is read by her.\n\n**Conditional:**\nâ€¢ Type 0: If + present, present (general truth)\nâ€¢ Type 1: If + present, will + V1 (possible)\nâ€¢ Type 2: If + past, would + V1 (hypothetical)\nâ€¢ Type 3: If + past perfect, would have + V3 (impossible)\n\n**Tips IELTS/TOEFL:** Practice daily speaking, extensive reading, vocab builder apps ğŸ¯`},
],

kesehatan:[
  {q:["gizi","nutrisi","makanan","diet","berat badan","kalori","metabolisme"],
  a:`ğŸ¥— **Nutrisi & Gizi â€” Panduan Ilmiah**\n\n**Kalori & Metabolisme:**\nâ€¢ Pria dewasa: ~2000-2500 kkal/hari\nâ€¢ Wanita dewasa: ~1600-2000 kkal/hari\nâ€¢ BMR (Basal Metabolic Rate) = energi istirahat\nâ€¢ BMR pria â‰ˆ 88.36 + 13.4Ã—kg + 4.8Ã—cm - 5.7Ã—usia\n\n**Makronutrien:**\nâ€¢ Karbohidrat: 4 kkal/gram\nâ€¢ Protein: 4 kkal/gram\nâ€¢ Lemak: 9 kkal/gram\nâ€¢ Alkohol: 7 kkal/gram\n\n**Protein Hewani vs Nabati:**\nâ€¢ Hewani: complete protein (semua asam amino esensial)\nâ€¢ Nabati: incomplete â€” kombinasikan (nasi+kacang = complete!)\n\n**Diet Evidence-Based:**\nâ€¢ Mediterranean â€” terbaik untuk jantung & otak\nâ€¢ DASH â€” turunkan tekanan darah\nâ€¢ Whole food plant-based â€” baik untuk lingkungan\n\n**Hindari:**\nâŒ Ultra-processed food (kurangi 80%)\nâŒ Gula tambahan >25g/hari (WHO)\nâŒ Garam >5g/hari\nâŒ Trans fat (margarin, fast food) ğŸ¥¦`},
  {q:["olahraga","latihan","gym","lari","kesehatan jantung","kebugaran","hiit"],
  a:`ğŸ’ª **Panduan Olahraga Ilmiah**\n\n**Zona Denyut Jantung:**\nâ€¢ Zona 1 (50-60% HR max) â€” pemulihan aktif\nâ€¢ Zona 2 (60-70%) â€” fat burning, ketahanan\nâ€¢ Zona 3 (70-80%) â€” aerobik, efisiensi\nâ€¢ Zona 4 (80-90%) â€” anaerobik, laktat threshold\nâ€¢ Zona 5 (90-100%) â€” VO2 max, sprint\n\nHR max â‰ˆ 220 - umur\n\n**Program Rekomendasi WHO:**\nâ€¢ 150-300 menit/minggu aktivitas aerobik sedang\nâ€¢ 2x+ latihan kekuatan otot besar\nâ€¢ Kurangi duduk berkepanjangan\n\n**Progressive Overload:**\nNaikkan beban/reps/set secara bertahap 5-10%/minggu\n\n**Recovery:**\nâ€¢ Otot tumbuh saat istirahat, bukan saat latihan!\nâ€¢ Sleep 7-9 jam = produksi growth hormone puncak\nâ€¢ Nutrisi: protein 1.6-2.2g/kg BB/hari\n\n**VO2 Max:** Indikator kebugaran kardiorespirasi. Tingkatkan dengan Zone 2 training & HIIT ğŸƒ`},
  {q:["stres","mental","anxiety","depresi","mindfulness","meditasi","terapi"],
  a:`ğŸ§  **Kesehatan Mental â€” Berbasis Sains**\n\n**Neurobiologi Stres:**\nâ€¢ Kortisol & adrenalin â†’ fight-or-flight\nâ€¢ Amigdala hiperaktif â†’ kecemasan kronis\nâ€¢ Hippocampus mengecil akibat stres kronik\n\n**Evidence-Based Interventions:**\n\nğŸ§˜ **Mindfulness (MBSR):**\nâ€¢ Terbukti kurangi kecemasan 40%\nâ€¢ 8 minggu program = ubah struktur otak!\nâ€¢ Praktik: scan tubuh, napas sadar, meditasi\n\nğŸ’Š **CBT (Cognitive Behavioral Therapy):**\nâ€¢ Restrukturisasi pikiran negatif\nâ€¢ Behavioral activation\nâ€¢ Exposure therapy\n\nğŸƒ **Olahraga:**\nâ€¢ Efektif setara antidepresan ringan!\nâ€¢ BDNF (Brain-Derived Neurotrophic Factor) = "pupuk otak"\n\nğŸ’¤ **Tidur:**\nKurang tidur â†’ kortisol naik, imun turun, emosi labil\n\n**Kapan ke Profesional:**\nJika >2 minggu mengganggu fungsi sehari-hari.\nPsikolog & psikiater tersedia offline maupun online ğŸ’™`},
],

motivasi:[
  {q:["motivasi","semangat","inspirasi","bangkit","sukses","tujuan","impian"],
  a:`ğŸ’ª **Ilmu Motivasi & Kesuksesan**\n\n**Self-Determination Theory (Deci & Ryan):**\n3 kebutuhan dasar manusia untuk motivasi intrinsik:\n1. **Otonomi** â€” merasa punya kendali\n2. **Kompetensi** â€” merasa berkembang\n3. **Keterhubungan** â€” merasa terhubung dengan orang lain\n\n**Growth Mindset (Carol Dweck):**\nâ€¢ Fixed: "Aku tidak bisa" â†’ menyerah\nâ€¢ Growth: "Aku belum bisa" â†’ terus belajar\n\n**Grit (Angela Duckworth):**\nGrit = Passion + Perseverance\nLebih prediktif keberhasilan daripada IQ!\n\n**Deliberate Practice (Anders Ericsson):**\n10.000 jam tidak cukup â€” harus **terstruktur + fokus + feedback**\n\nâœ¨ **Kutipan yang Terbukti Mengubah Pola Pikir:**\n\n*"Whether you think you can, or you think you can't â€” you're right."* â€” Henry Ford\n\n*"The secret of getting ahead is getting started."* â€” Mark Twain\n\n*"Tidak ada yang gagal, hanya belajar cara yang tidak berhasil."* â€” Edison\n\nKamu lebih dekat ke tujuanmu daripada yang kamu kira! ğŸš€`},
  {q:["produktivitas","fokus","habit","kebiasaan","waktu","belajar efektif"],
  a:`â° **Sistem Produktivitas Terbaik di Dunia**\n\n**Deep Work (Cal Newport):**\nâ€¢ Kerja fokus tanpa distraksi = paling produktif\nâ€¢ Bangun ritual: waktu, tempat, durasi\nâ€¢ Targetkan 4 jam deep work/hari\n\n**Atomic Habits (James Clear):**\nâ€¢ Habit loop: Cue â†’ Craving â†’ Response â†’ Reward\nâ€¢ 1% lebih baik setiap hari = 37x lebih baik dalam setahun!\nâ€¢ Habit stacking: Setelah X, aku akan Y\nâ€¢ Environment design: buat kebaikan mudah, keburukan sulit\n\n**GTD (Getting Things Done):**\nâ€¢ Capture â†’ Clarify â†’ Organize â†’ Reflect â†’ Engage\n\n**Teknik Belajar Terbaik:**\nğŸ¥‡ Spaced repetition (Anki)\nğŸ¥ˆ Active recall / self-testing\nğŸ¥‰ Interleaved practice\n4ï¸âƒ£ Elaborative interrogation\n5ï¸âƒ£ Pomodoro untuk fokus\n\n**Kesalahan Umum:**\nâŒ Multitasking (turunkan efisiensi 40%!)\nâŒ Social media saat belajar\nâŒ Belajar dalam satu sesi panjang\nâŒ Highlight & membaca ulang (tidak efektif!)`},
],

memasak:[
  {q:["masak","memasak","resep","kuliner","dapur","bahan makanan","cara membuat"],
  a:`ğŸ³ **Panduan Memasak untuk Pemula**\n\n**5 Teknik Dasar Memasak:**\n1. **Menumis (SautÃ©ing)** â€” wajan panas, sedikit minyak, cepat\n2. **Merebus (Boiling)** â€” air mendidih 100Â°C\n3. **Menggoreng (Frying)** â€” deep fry vs shallow fry\n4. **Memanggang (Roasting/Baking)** â€” panas kering oven\n5. **Mengukus (Steaming)** â€” panas uap, nutrisi terjaga\n\n**Bumbu Dasar Indonesia:**\nâ€¢ Bumbu putih: bawang merah, bawang putih, kemiri, jahe\nâ€¢ Bumbu kuning: + kunyit\nâ€¢ Bumbu merah: + cabe merah/rawit\nâ€¢ Bumbu hitam: + kluwek (rawon)\n\n**Tips Memasak:**\nâœ… Mise en place â€” siapkan bahan sebelum mulai\nâœ… Rasa saat memasak, bukan saat di piring\nâœ… Minyak harus panas sebelum bahan masuk\nâœ… Jangan terlalu sering aduk (biarkan karamelisasi)\nâœ… Istirahatkan daging setelah dimasak 5 menit\n\n**Ingin resep spesifik?**\nKetik: "resep nasi goreng", "resep rendang", "resep soto ayam", "resep gado-gado", "resep mie goreng", "resep pempek", "resep bakso", atau "resep martabak"! ğŸŒ¶ï¸`},
],

hukum:[
  {q:["hukum","undang-undang","konstitusi","uud","pengadilan","hak","kewajiban","pidana","perdata"],
  a:`âš–ï¸ **Hukum Indonesia â€” Dasar-Dasar**\n\n**Hierarki Peraturan (UU No. 12/2011):**\n1. UUD 1945\n2. TAP MPR\n3. UU / Perppu\n4. PP (Peraturan Pemerintah)\n5. Perpres (Peraturan Presiden)\n6. Perda Provinsi\n7. Perda Kabupaten/Kota\n\n**Cabang Hukum Utama:**\n\nâš–ï¸ **Hukum Pidana** â€” sanksi negara terhadap pelanggaran\nâ€¢ KUHP (Kitab Undang-Undang Hukum Pidana)\nâ€¢ Unsur: actus reus (perbuatan) + mens rea (niat)\n\nğŸ“‹ **Hukum Perdata** â€” hubungan antar individu\nâ€¢ KUH Perdata (BW): kontrak, harta, keluarga\nâ€¢ Ganti rugi, bukan penjara\n\nğŸ›ï¸ **Hukum Tata Negara** â€” struktur negara & kekuasaan\nâ€¢ Lembaga: DPR, DPD, MPR, MA, MK, KY\n\n**Hak Warga Negara (UUD 1945 Pasal 27-34):**\nâ€¢ Hak atas pekerjaan\nâ€¢ Hak atas pendidikan\nâ€¢ Hak atas kesehatan\nâ€¢ Hak beragama\nâ€¢ Hak berpendapat\n\n**Jika terkena masalah hukum:** Hubungi LBH (Lembaga Bantuan Hukum) terdekat âš–ï¸`},
],

parenting:[
  {q:["parenting","anak","mendidik anak","pola asuh","perkembangan anak","remaja","tumbuh kembang"],
  a:`ğŸ‘¶ **Parenting â€” Ilmu Mendidik Anak**\n\n**Tahap Perkembangan (Piaget):**\nâ€¢ 0-2th: Sensorimotor â€” belajar melalui indera & gerak\nâ€¢ 2-7th: Praoperasional â€” bahasa berkembang, egosentris\nâ€¢ 7-11th: Operasional Konkret â€” logika + benda nyata\nâ€¢ 11th+: Operasional Formal â€” abstrak & hipotetis\n\n**4 Gaya Parenting (Baumrind):**\nâ€¢ **Authoritative** (terbaik) â€” hangat + konsisten + fleksibel\nâ€¢ Authoritarian â€” ketat tapi dingin â†’ anak penakut\nâ€¢ Permissive â€” hangat tapi tidak konsisten â†’ kurang mandiri\nâ€¢ Neglectful â€” kurang perhatian â†’ masalah sosial\n\n**Tips Komunikasi Efektif:**\nâœ… Active listening â€” dengarkan tanpa menghakimi\nâœ… Validasi perasaan: "Aku mengerti kamu marah..."\nâœ… Batasan yang jelas tapi penuh cinta\nâœ… Konsisten antara apa yang diucapkan & dilakukan\nâœ… Quality time tanpa gadget\n\n**Screen Time Rekomendasi (WHO):**\nâ€¢ <2th: hindari sama sekali\nâ€¢ 2-5th: max 1 jam/hari\nâ€¢ 6th+: batas yang sehat + konten berkualitas ğŸ‘¨â€ğŸ‘©â€ğŸ‘§`},
],

alam:[
  {q:["lingkungan","ekologi","biodiversitas","ekosistem","konservasi","hutan","laut","satwa"],
  a:`ğŸŒ¿ **Ekologi & Konservasi Alam**\n\n**Piramida Ekologi:**\nProdusen â†’ Konsumen I â†’ Konsumen II â†’ Konsumen III â†’ Dekomposer\n\n**Siklus Nutrisi Penting:**\nâ€¢ Siklus karbon â†’ iklim, fotosintesis\nâ€¢ Siklus nitrogen â†’ protein, pupuk\nâ€¢ Siklus air â†’ cuaca, ekosistem\n\n**Keanekaragaman Hayati Indonesia:**\nâ€¢ 515 spesies mamalia (17% dunia)\nâ€¢ 1.539 spesies burung (17% dunia)\nâ€¢ 45.000 spesies tumbuhan (11% dunia)\nâ€¢ Segitiga Terumbu Karang â†’ 76% spesies karang\n\n**Spesies Kunci Indonesia:**\nğŸ¦§ Orangutan (Sumatera & Kalimantan)\nğŸ¦ Komodo (Flores & Rinca)\nğŸ˜ Gajah Sumatera\nğŸ… Harimau Sumatera (kritis!)\nğŸ¦… Jalak Bali (hampir punah)\n\n**Ancaman:**\nDeforestasi, perburuan, polusi, perubahan iklim, spesies invasif\n\n**Apa yang Bisa Kita Lakukan?**\nâ™»ï¸ 4R: Refuse, Reduce, Reuse, Recycle\nğŸŒ± Tanam pohon, pilih produk berkelanjutan\nğŸ—£ï¸ Edukasi lingkungan ğŸŒ`},
],

chat:[
  {q:["halo","hai","hello","hey","hi","hy","selamat datang","pagi","siang","malam","assalamualaikum"],
  a:`Halo! Senang sekali bertemu kamu! ğŸ˜Šâœ¨\n\nAku **NusantaraAI v3.0** â€” teman cerdas yang bisa membantu dengan:\nğŸ® Kuis interaktif (50+ soal)\nğŸ”¤ Game tebak kata seru\nğŸŒ Terjemahan Indonesia â†” Inggris\nğŸ”„ Konversi satuan (suhu, panjang, berat)\nğŸ³ Resep masakan nusantara\nğŸ“š 2500+ topik pengetahuan\nğŸ”¢ Kalkulator canggih\n\nMau mulai dengan apa hari ini? ğŸ˜„`},
  {q:["siapa kamu","kamu siapa","nama kamu","perkenalan","tentang kamu"],
  a:`Perkenalkan, aku **NusantaraAI v3.0 PRO**! ğŸŒŸ\n\nâœ… Bekerja **100% offline** tanpa internet\nâœ… **2500+ topik** dari 18 kategori\nâœ… **AI yang ramah & sopan** â€” selalu!\nâœ… Fitur: Kuis, Tebak Kata, Terjemahan, Konverter, Kalkulator, Resep\nâœ… Mode terang & gelap\nâœ… Ingat riwayat percakapan\n\nNama kamu siapa? Senang berkenalan! ğŸ˜Š`},
  {q:["apa kabar","kabarmu","gimana kabar","how are you"],
  a:`Baik banget! Terima kasih sudah tanya ğŸ˜Š\n\nSetiap percakapan baru selalu bikin senang. Ada yang menarik yang ingin kamu pelajari atau diskusikan hari ini?\n\nAtau mau langsung mulai kuis, game tebak kata, atau terjemahan? ğŸŒŸ`},
  {q:["terima kasih","makasih","thanks","thank you","tq"],
  a:`Sama-sama! Senang bisa membantu! ğŸ˜Šâœ¨\n\nJangan ragu tanya lagi kapan saja ya â€” aku selalu siap! ğŸŒŸ`},
  {q:["bosan","gabut","boring","jenuh","tidak ada kerjaan"],
  a:`Wah, bosan? Aku punya banyak hiburan! ğŸ˜„\n\nğŸ® Ketik **"mulai kuis"** â€” tes pengetahuanmu!\nğŸ”¤ Ketik **"tebak kata"** â€” game seru!\nğŸ² Ketik **"fakta acak"** â€” fakta bikin melongo!\nğŸ§© Ketik **"teka-teki"** â€” asah otakmu!\nğŸ’ª Ketik **"cerita motivasi"** â€” cerita inspirasi tokoh dunia!\nğŸ³ Ketik **"resep rendang"** â€” belajar masak!\n\nMana yang paling menarik? ğŸ˜Š`},
  {q:["lucu","jokes","lelucon","humor"],
  a:`Hahaha, mau jokes? Siap! ğŸ˜„\n\nğŸ¤£ **Joke 1 â€” Programmer:**\nKenapa programmer selalu bingung antara Halloween dan Natal?\nKarena **Oct 31 = Dec 25**!\n(Oktal 31 = Desimal 25) ğŸ˜‚\n\nğŸ¤£ **Joke 2 â€” Kimia:**\nDua atom helium bertemu. Yang satu bilang: "Aku kehilangan elektron!"\nYang lain: "Yakin?"\n"Ya, aku **He**lium yang positif!"\n\nğŸ¤£ **Joke 3 â€” Fisika:**\nSchrodinger memarkir mobilnya. Polisi: "Anda parkir di tempat terlarang!"\nSchrodinger: "Tapi tidak ada tanda-tanda!"\nPolisi: *membuka bagasi* "Ada kucing mati di sini!"\nSchrodinger: "Astaga, sekarang ada!" ğŸ˜‚\n\nMau lagi? Atau mau teka-teki? ğŸ­`},
  {q:["teka-teki","riddle","tebak"],
  a:`Ooh suka teka-teki! ğŸ§©\n\n**Teka-teki 1:**\n*Aku bisa berlari tapi tidak punya kaki. Aku bisa menangis tapi tidak punya mata. Aku datang dari langit tapi bukan malaikat. Siapa aku?*\n\nğŸ’¡ Jawaban: **Hujan!** ğŸŒ§ï¸\n\n**Teka-teki 2:**\n*Aku punya kepala tapi tidak punya otak. Punya ekor tapi tidak punya badan. Apa aku?*\n\nğŸ’¡ Jawaban: **Koin!** ğŸª™\n\n**Teka-teki 3:**\n*Semakin banyak kamu mengambilnya, semakin besar aku. Tapi jika kamu terus mengisi, aku menghilang. Apa aku?*\n\nğŸ’¡ Jawaban: **Lubang!** ğŸ•³ï¸\n\nMau yang lebih sulit? ğŸ˜„`},
  {q:["sedih","galau","down","curhat","patah hati","kecewa","lelah","berat"],
  a:`Hei, aku di sini untukmu... ğŸ’™\n\nTidak apa-apa merasa begitu. Perasaanmu valid.\n\nKalau kamu mau cerita, aku mendengarkan. Kalau belum siap, juga tidak apa-apa.\n\n**Ingat:**\nğŸŒ¤ï¸ Setelah hujan pasti ada pelangi\nğŸ’™ Kamu tidak sendirian\nğŸ’ª Kamu sudah melewati 100% hari sulitmu sebelumnya\nğŸŒ± Setiap hari adalah halaman baru\n\nJika kamu merasa sangat tidak baik, hubungi seseorang yang kamu percaya ya. Kamu berharga! ğŸ«‚`},
]
};

// ================================================================
//  RANDOM FACTS
// ================================================================
const FACTS = [
  "ğŸ§  Otakmu menghasilkan energi setara lampu 25 watt! Kamu bercahaya secara harfiah!",
  "ğŸ™ Gurita punya 3 jantung, 9 otak, & darah biru. Makhluk paling aneh di Bumi!",
  "âš¡ Petir menyambar Bumi ~100 kali per DETIK. Saat kamu baca ini, ribuan petir sudah terjadi!",
  "ğŸŒŠ 95% lautan Bumi belum pernah dijelajahi manusia. Kita lebih tahu tentang Mars!",
  "ğŸ¦  Tubuhmu punya 10Ã— lebih banyak sel bakteri daripada sel manusia. Kamu lebih bakteri dari manusia!",
  "â± Jika umur Bumi dipadatkan jadi 1 tahun, manusia muncul pada 23:58 menit terakhir!",
  "ğŸŒ¡ï¸ Panas tubuhmu cukup untuk mendidihkan 1,5 liter air dalam 30 menit!",
  "ğŸ¢ Kura-kura bisa bernapas melalui pantatnya (kloaka) di musim dingin!",
  "ğŸµ Musik bisa mengurangi persepsi rasa sakit hingga 21% â€” lebih ampuh dari beberapa obat penghilang rasa sakit!",
  "ğŸ’ Berlian bisa dibakar pada ~700Â°C â€” semuanya berubah jadi COâ‚‚!",
  "ğŸŒ¸ Semut dapat mengangkat 50Ã— beratnya sendiri. Jika manusia sekuat itu, kita bisa angkat mobil!",
  "ğŸ§¬ DNA semua manusia 99,9% identik. Semua perbedaan kita ada di 0,1%!",
  "ğŸ Lebah madu harus kunjungi 2 JUTA bunga untuk buat 450g madu. Dedikasi luar biasa!",
  "ğŸŒ™ Neil Armstrong pergi ke Bulan membawa lebih sedikit computing power dari HP-mu!",
  "ğŸ”¢ Jika hitung dari 1 ke 1 juta nonstop (1/detik) â†’ butuh 11,5 hari!",
  "ğŸ¦ˆ Hiu lebih tua dari pohon â€” hiu sudah ada 450 juta tahun, pohon baru 350 juta tahun!",
  "â„ï¸ Tiap kepingan salju unik karena perjalanannya dari awan ke bumi berbeda-beda!",
  "ğŸš€ Voyager 1 (1977) masih bergerak â€” sudah 23+ miliar km dari Bumi & terus berlanjut!"
];

const MOTI_STORIES = [
  `ğŸ’¡ **Edison & 10.000 Percobaan**\n\nSeorang wartawan bertanya: "Pak Edison, bagaimana rasanya gagal 10.000 kali?"\n\nEdison tersenyum: *"Aku tidak pernah gagal satu pun. Aku berhasil menemukan 10.000 cara yang tidak berhasil."*\n\nDia tidak berhenti. Dia mengubah dunia.\n\nâœ¨ **Pesan:** Kegagalan adalah data, bukan kekalahan. Setiap "tidak berhasil" membawamu lebih dekat ke yang berhasil! ğŸ’ª`,
  `ğŸ€ **Michael Jordan â€” Gagal Lolos Seleksi**\n\nSebagai remaja 15 tahun, Jordan tidak lolos seleksi tim basket sekolah. Dia pulang ke kamar, dan menangis sendirian.\n\nTapi dia bangkit. Berlatih jam 6 pagi setiap hari sebelum sekolah. Sendirian.\n\nHasilnya? 6Ã— juara NBA. 5Ã— MVP. Emas Olimpiade. Diklaim terbaik sepanjang masa.\n\nâœ¨ "Saya bisa menerima kegagalan â€” semua orang bisa gagal. Tapi saya tidak bisa menerima tidak mencoba." ğŸ”¥`,
  `ğŸ“š **J.K. Rowling â€” 12 Penolakan**\n\n12 penerbit menolak Harry Potter. Dia single parent, menganggur, hidup dari tunjangan sosial. Menulis di kafe karena apartemen tidak hangat.\n\nPenerbit ke-13 menerima... karena putri CEO memaksa ayahnya membaca bab pertama!\n\nHasilnya? 500+ juta buku. 80+ bahasa. Franchise $25 miliar. Rowling jadi orang terkaya di Inggris.\n\nâœ¨ **Pesan:** Satu "ya" setelah seribu "tidak" sudah cukup untuk mengubah segalanya! ğŸŒŸ`,
  `ğŸ¸ **The Beatles â€” Ditolak Label Rekaman**\n\n1962: Decca Records menolak The Beatles.\n*"Grup gitar tidak tren. Suara mereka tidak menarik."*\n\n14 label lain juga menolak.\n\nTapi mereka terus manggung, terus berlatih, terus menulis lagu.\n\nHasilnya? Band terlaris sepanjang masa. 600+ juta album. Mengubah musik selamanya.\n\nâœ¨ **Pesan:** Orang yang menolakmu tidak mendefinisikan nilaimu. Terus berkarya! ğŸµ`,
  `ğŸŒ **Nelson Mandela â€” 27 Tahun di Penjara**\n\nDipenjara 27 tahun karena melawan apartheid. Ditawarkan kebebasan dengan syarat meninggalkan perlawanan â€” dia menolak.\n\nKeluar dari penjara 1990. Menjadi presiden pertama kulit hitam Afrika Selatan 1994.\n\nKatanya: *"Saya tidak pernah kalah. Saya menang atau belajar."*\n\nâœ¨ **Pesan:** Tidak ada situasi yang bisa merebut martabat dan semangatmu, kecuali kamu yang menyerahkannya! ğŸ•Šï¸`
];

// ================================================================
//  WORD GAME STATE
// ================================================================
let wgActive=false, wgWord='', wgHint='', wgGuessed=[], wgWrong=0, wgMaxWrong=6;
const HANGMAN_STAGES = [
  "  ___\n |   |\n |\n |\n |\\",
  "  ___\n |   |\n |   O\n |\n |\\",
  "  ___\n |   |\n |   O\n |   |\n |\\",
  "  ___\n |   |\n |   O\n |  /|\n |\\",
  "  ___\n |   |\n |   O\n |  /|\\\n |\\",
  "  ___\n |   |\n |   O\n |  /|\\\n |  /\n |\\",
  "  ___\n |   |\n |   O\n |  /|\\\n |  / \\\n |\\"
];

function startWordGame() {
  const pick = WORDS[Math.floor(Math.random()*WORDS.length)];
  wgWord = pick.w; wgHint = pick.h;
  wgGuessed = []; wgWrong = 0; wgActive = true;
  renderWordGame();
  return null;
}

function renderWordGame() {
  const welcomeEl = document.getElementById('wel');
  if (welcomeEl) welcomeEl.remove();
  const ca = document.getElementById('ca');
  const el = document.createElement('div');
  el.className = 'm ai'; el.id='wg-container';

  const letters = wgWord.split('').map(l=>{
    const shown = wgGuessed.includes(l);
    return `<div class="wg-l ${shown?'shown':''}">${shown?l:''}</div>`;
  }).join('');

  const alpha = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.split('').map(l=>{
    const hit = wgGuessed.includes(l) && wgWord.includes(l);
    const miss = wgGuessed.includes(l) && !wgWord.includes(l);
    return `<button class="wgk ${hit?'hit':''} ${miss?'miss':''}" 
      onclick="guessLetter('${l}',this)" 
      ${wgGuessed.includes(l)?'disabled':''}>${l}</button>`;
  }).join('');

  const stage = HANGMAN_STAGES[wgWrong];
  const wrongLetters = wgGuessed.filter(l=>!wgWord.includes(l)).join(' ');
  const isWon = wgWord.split('').every(l=>wgGuessed.includes(l));
  const isLost = wgWrong >= wgMaxWrong;

  let status = '';
  if (isWon) status = `<div class="tag g" style="font-size:13px;margin-top:8px">ğŸ‰ Hebat! Kata: <strong>${wgWord}</strong></div>`;
  else if (isLost) status = `<div class="tag r" style="font-size:13px;margin-top:8px">ğŸ˜… Jawabannya: <strong>${wgWord}</strong></div>`;

  el.innerHTML = `
    <div class="mav">ğŸŒŸ</div>
    <div style="max-width:90%">
      <div class="bbl">
        <div class="tag i">ğŸ”¤ Game Tebak Kata</div>
        <div class="card">
          <div class="card-title">â“ Tebak kata ini!</div>
          <div style="font-size:11px;color:var(--tm);margin-bottom:8px">ğŸ’¡ Petunjuk: ${wgHint}</div>
          <div class="hangman">${stage}</div>
          <div style="font-size:10px;color:var(--a3);margin:4px 0">Salah: ${wrongLetters||'-'} (${wgWrong}/${wgMaxWrong})</div>
          <div class="wg-word">${letters}</div>
          ${!isWon && !isLost ? `<div class="wg-kb">${alpha}</div>` : ''}
          ${status}
          ${(isWon||isLost)?`<button class="ck eq" style="margin-top:10px;padding:7px 16px;border-radius:8px;cursor:pointer" onclick="qs('mulai game tebak kata')">ğŸ”„ Main Lagi</button>`:''}
        </div>
      </div>
      <div class="mmeta">NusantaraAI â€¢ ${getTime()}</div>
    </div>
  `;
  ca.appendChild(el);
  ca.scrollTop = ca.scrollHeight;
  msgCount++;
  updateStats();
}

function guessLetter(letter, btn) {
  if (!wgActive || wgGuessed.includes(letter)) return;
  wgGuessed.push(letter);
  if (!wgWord.includes(letter)) wgWrong++;
  const old = document.getElementById('wg-container');
  if (old) old.remove();
  const isWon = wgWord.split('').every(l=>wgGuessed.includes(l));
  const isLost = wgWrong >= wgMaxWrong;
  if (isWon || isLost) { wgActive = false; totalScore += isWon?10:0; }
  renderWordGame();
}

// ================================================================
//  TRANSLATE
// ================================================================
function translateText(text, toLang) {
  const words = text.toLowerCase().trim().split(/\s+/);
  let result = [];
  let i = 0;
  while (i < words.length) {
    let found = false;
    // Try 2-word phrase first
    if (i+1 < words.length) {
      const phrase = words[i]+' '+words[i+1];
      if (toLang === 'en' && DICT_ID_EN[phrase]) {
        result.push(DICT_ID_EN[phrase]); i += 2; found = true;
      } else if (toLang === 'id' && DICT_EN_ID[phrase]) {
        result.push(DICT_EN_ID[phrase]); i += 2; found = true;
      }
    }
    if (!found) {
      const word = words[i];
      if (toLang === 'en') result.push(DICT_ID_EN[word] || `[${word}]`);
      else result.push(DICT_EN_ID[word] || `[${word}]`);
      i++;
    }
  }
  return result.join(' ');
}

function renderTranslate(input, toLang) {
  const translated = translateText(input, toLang);
  const fromLang = toLang === 'en' ? 'ğŸ‡®ğŸ‡© Indonesia' : 'ğŸ‡¬ğŸ‡§ Inggris';
  const toLabel = toLang === 'en' ? 'ğŸ‡¬ğŸ‡§ Inggris' : 'ğŸ‡®ğŸ‡© Indonesia';
  return `ğŸŒ **Terjemahan**\n\n<div class="tbox"><div><div class="tlabel">${fromLang}</div><div class="tpanel">${input}</div></div><div><div class="tlabel">${toLabel}</div><div class="tpanel">${translated}</div></div></div>\n\nTerjemahkan kata/kalimat lain?\nContoh: *"terjemahkan 'aku suka belajar' ke inggris"* atau *"translate 'I love Indonesia' to Indonesian"* ğŸŒ`;
}

// ================================================================
//  CONVERTER RENDERER
// ================================================================
function renderConverter(catKey) {
  const cat = CONV[catKey];
  if (!cat) return null;
  const pairsHtml = cat.pairs.map((p,i)=>`
    <div class="card" style="margin:6px 0">
      <div class="card-title" style="font-size:12px">${p.from} â†’ ${p.to}</div>
      <div class="cvgrid">
        <input class="cvinp" type="number" placeholder="Nilai" id="cv${catKey}${i}in" oninput="cvCalc('${catKey}',${i})" step="any">
        <span class="cvarrow">â‡„</span>
        <div>
          <div class="cvres" id="cv${catKey}${i}out">â€”</div>
          <div class="cvunit">${p.to}</div>
        </div>
      </div>
    </div>
  `).join('');
  return `ğŸ”„ **Konverter ${cat.label}**\n\n${pairsHtml}\n\nKonverter lain: ketik **"konverter panjang"**, **"konverter berat"**, **"konverter waktu"**, atau **"konverter kecepatan"**! ğŸ”„`;
}

function cvCalc(catKey, idx) {
  const inp = document.getElementById(`cv${catKey}${idx}in`);
  const out = document.getElementById(`cv${catKey}${idx}out`);
  if (!inp || !out) return;
  const v = parseFloat(inp.value);
  if (isNaN(v)) { out.textContent = 'â€”'; return; }
  const result = CONV[catKey].pairs[idx].fn(v);
  out.textContent = parseFloat(result.toFixed(6));
}

// ================================================================
//  RECIPE RENDERER
// ================================================================
function renderRecipe(key) {
  const r = RECIPES[key];
  if (!r) return null;
  const bahan = r.bahan.map((b,i)=>`<li><span class="rnum">${i+1}.</span>${b}</li>`).join('');
  const cara = r.cara.map((c,i)=>`<li><span class="rnum">${i+1}.</span>${c}</li>`).join('');
  return `${r.name}\n\n<div class="card"><div class="card-title">ğŸ›’ Bahan-bahan</div><ul class="rlist">${bahan}</ul></div><div class="card"><div class="card-title">ğŸ‘©â€ğŸ³ Cara Memasak</div><ul class="rlist">${cara}</ul></div>\n\nSelamat mencoba! ğŸ˜‹ Butuh resep lain? Ketik resep yang kamu mau!`;
}

// ================================================================
//  QUIZ ENGINE
// ================================================================
let qQueue=[], qIdx=0, qAnswered=false;

function startQuiz() {
  qQueue = [...QUIZ].sort(()=>Math.random()-.5).slice(0,7);
  qIdx = 0;
  renderQ();
  return null;
}

function renderQ() {
  if (qIdx >= qQueue.length) { return addMsg(`ğŸ‰ **Kuis selesai!** Skor: **${quizRight}/${quizTotal}** â€” ${quizRight>=qQueue.length*.7?'Luar biasa! ğŸ†':'Terus semangat belajar! ğŸ’ª'}\n\nKetik **"mulai kuis"** lagi untuk sesi baru!`,'ai'); }
  const q = qQueue[qIdx]; qAnswered = false;
  const welcomeEl = document.getElementById('wel');
  if (welcomeEl) welcomeEl.remove();
  const ca = document.getElementById('ca');
  const el = document.createElement('div');
  el.className = 'm ai'; el.id=`q${qIdx}`;
  const opts = q.o.map((o,i)=>`<button class="qo" onclick="answerQ(${i},${q.a},this,'q${qIdx}')">${String.fromCharCode(65+i)}. ${o}</button>`).join('');
  el.innerHTML=`<div class="mav">ğŸŒŸ</div><div style="max-width:90%"><div class="bbl"><div class="tag i">Soal ${qIdx+1}/${qQueue.length}</div><div class="card"><div class="card-title">â“ ${q.q}</div><div class="qopts">${opts}</div><div class="qres" id="qr${qIdx}" style="display:none"></div></div></div><div class="mmeta">NusantaraAI â€¢ ${getTime()}</div></div>`;
  ca.appendChild(el);
  ca.scrollTop=ca.scrollHeight;
  msgCount++; quizTotal++; updateStats();
}

function answerQ(choice, correct, btn, qid) {
  if (qAnswered) return;
  qAnswered = true;
  const opts = btn.parentElement.querySelectorAll('.qo');
  const res = document.getElementById('qr'+qIdx.toString());
  opts.forEach(o=>o.disabled=true);
  opts[correct].classList.add('ok');
  if (choice===correct) {
    quizRight++; totalScore+=10; btn.classList.add('ok');
    res.style.cssText='display:block;background:rgba(52,211,153,.1);color:var(--a2)';
    res.textContent='âœ… Benar! +10 poin ğŸ‰';
  } else {
    btn.classList.add('no');
    res.style.cssText='display:block;background:rgba(251,113,133,.1);color:var(--a3)';
    res.textContent=`âŒ Jawaban benar: ${String.fromCharCode(65+correct)}. ${qQueue[qIdx].o[correct]}`;
  }
  updateStats();
  qIdx++;
  setTimeout(()=>renderQ(), 1400);
}

// ================================================================
//  MAIN RESPONSE ENGINE
// ================================================================
function findResponse(input) {
  const low = input.toLowerCase().trim();

  // Detect name
  const nmRx = /(?:nama(?:\s+saya|ku|\s+aku)?|panggil(?:\s+aku|\s+saya)?|aku\s+(?:adalah|bernama)|saya\s+(?:adalah|bernama))\s+([a-zA-Z]{2,20})/i;
  const nm = low.match(nmRx);
  if (nm) {
    const c = nm[1];
    if (!['yang','tidak','itu','dan','ada','mau','bisa','harus','akan','kamu','siapa'].includes(c.toLowerCase()))
      userName = c.charAt(0).toUpperCase()+c.slice(1).toLowerCase();
  }

  // Detect mood
  if (/senang|bahagia|semangat|excited|gembira/.test(low)) { userMood='semangat ğŸ˜„'; updateStats(); }
  else if (/sedih|galau|down|lelah|capek/.test(low)) { userMood='sedang berat ğŸ’™'; updateStats(); }
  else if (/belajar|belajar|tugas|ujian|pr\b/.test(low)) { userMood='belajar ğŸ“š'; updateStats(); }

  // QUIZ
  if (/mulai\s*kuis|kuis|quiz|soal pengetahuan|tes\s*aku/.test(low)) return startQuiz();

  // WORD GAME
  if (/tebak\s*kata|game\s*tebak|hangman|mulai\s*game/.test(low)) return startWordGame();

  // TRANSLATOR
  const transMatch = low.match(/(?:terjemahkan?|translate?|artikan?)\s+['"]?(.+?)['"]?\s+(?:ke|to|dalam)\s+(inggris|english|indonesia|id)/i);
  if (transMatch) {
    const text = transMatch[1];
    const toLang = /inggris|english/.test(transMatch[2]) ? 'en' : 'id';
    return renderTranslate(text, toLang);
  }
  if (/^translate$|terjemahan|terjemahkan$|terjemahkan saya/.test(low)) {
    return `ğŸŒ **Mode Terjemahan Indonesia â†” Inggris**\n\nCara penggunaan:\nâ€¢ *"terjemahkan 'terima kasih' ke inggris"*\nâ€¢ *"translate 'good morning' ke indonesia"*\nâ€¢ *"artikan 'aku cinta Indonesia' to english"*\n\nAku punya 500+ kamus kata! Coba sekarang ğŸ˜Š`;
  }

  // CONVERTER
  const convMatch = low.match(/konvert(?:er)?(?:\s+)?(suhu|panjang|berat|waktu|kecepatan|temperature|length|weight|speed)/i);
  if (convMatch) {
    const k = {suhu:'suhu',temperature:'suhu',panjang:'panjang',length:'panjang',
      berat:'berat',weight:'berat',waktu:'waktu',kecepatan:'kecepatan',speed:'kecepatan'}[convMatch[1].toLowerCase()];
    if (k) return renderConverter(k);
  }
  if (/konverter$|konverter\s+unit|ubah\s+satuan/.test(low)) {
    return `ğŸ”„ **Konverter Satuan**\n\nPilih konverter:\nâ€¢ **"konverter suhu"** â€” Celsius, Fahrenheit, Kelvin\nâ€¢ **"konverter panjang"** â€” Meter, Km, Kaki, Inci\nâ€¢ **"konverter berat"** â€” Kg, Gram, Pound, Ton\nâ€¢ **"konverter waktu"** â€” Jam, Menit, Hari, Tahun\nâ€¢ **"konverter kecepatan"** â€” m/s, km/jam, Knot\n\nPilih yang kamu butuhkan! ğŸ˜Š`;
  }

  // RECIPE
  const recipeKeys = Object.keys(RECIPES);
  for (const rk of recipeKeys) {
    if (low.includes(rk) || (rk.includes(' ') && rk.split(' ').some(w=>low.includes(w)))) {
      const r = renderRecipe(rk);
      if (r) return r;
    }
  }
  if (/resep|cara\s+masak|bahan\s+masakan/.test(low)) {
    return `ğŸ³ **Koleksi Resep NusantaraAI**\n\nResep yang tersedia:\nâ€¢ **"resep nasi goreng"**\nâ€¢ **"resep rendang"**\nâ€¢ **"resep soto ayam"**\nâ€¢ **"resep gado-gado"**\nâ€¢ **"resep mie goreng"**\nâ€¢ **"resep pempek"**\nâ€¢ **"resep bakso"**\nâ€¢ **"resep martabak"**\n\nKetik nama resep yang kamu inginkan! ğŸ˜‹`;
  }

  // CALCULATOR
  if (/kalkulator|calculator/.test(low)) {
    openModal('mdcalc');
    return `ğŸ”¢ Kalkulator sudah kubuka! Bisa kamu gunakan dari jendela yang muncul.\n\nAtau ketik ekspresi matematika langsung di sini, aku akan hitung! ğŸ˜Š`;
  }

  // MATH EXPRESSION
  const mathExp = low.replace(/[^\d\s\+\-\*\/\(\)\.\^%]/g,'').trim();
  if (mathExp.length > 2 && /\d/.test(mathExp) && /[\+\-\*\/\^%]/.test(mathExp)) {
    try {
      const safe = mathExp.replace(/\^/g,'**');
      const res = Function('"use strict";return('+safe+')')();
      if (!isNaN(res)&&isFinite(res)) return `ğŸ”¢ **${mathExp.replace(/\*/g,'Ã—').replace(/\//g,'Ã·')} = ${parseFloat(res.toFixed(10))}**\n\nMau hitung yang lain? Atau buka kalkulator lengkap! ğŸ˜Š`;
    } catch(e){}
  }

  // RANDOM FACT
  if (/fakta\s*acak|random\s*fact|fakta\s*baru|fakta\s*seru/.test(low))
    return `ğŸ² **Fakta Acak:**\n\n${FACTS[Math.floor(Math.random()*FACTS.length)]}\n\nKetik "fakta acak" lagi untuk fakta lain! ğŸ˜„`;

  // MOTIVATIONAL STORY
  if (/cerita\s*motivasi|kisah\s*inspirasi|motivational|cerita\s*sukses/.test(low))
    return MOTI_STORIES[Math.floor(Math.random()*MOTI_STORIES.length)];

  // SEARCH KB
  let best=null, score=0;
  for (const cat of Object.values(KB)) {
    for (const item of cat) {
      let s=0;
      for (const kw of item.q) {
        if (low.includes(kw)) s+=kw.length*3;
        else {
          const words = low.split(/\s+/);
          for (const w of words) if (w.length>3&&kw.includes(w)) s+=w.length;
        }
      }
      if (s>score){score=s;best=item;}
    }
  }
  if (best&&score>3) return best.a;

  return getFallback(low);
}

function getFallback(inp) {
  const r = [
    `Menarik! ğŸ¤” Untuk topik spesifik itu aku belum punya info lengkap.\n\nTapi ada banyak hal lain yang bisa kita eksplorasi:\nğŸ® **"mulai kuis"** â€” tes pengetahuanmu\nğŸ”¤ **"tebak kata"** â€” game seru\nğŸŒ **"terjemahkan [teks] ke inggris"**\nğŸ”„ **"konverter suhu"**\nğŸ³ **"resep nasi goreng"**\nğŸ² **"fakta acak"**\n\nMau coba yang mana? ğŸ˜Š`,
    `Hmm, aku belum punya info spesifik tentang itu. ğŸ˜„\n\nAku paling andal di: sains, teknologi, sejarah, matematika, bahasa, budaya, kesehatan, ekonomi, psikologi, hukum, parenting, alam & lingkungan.\n\nAtau coba fitur interaktifku: kuis, tebak kata, terjemahan, atau konverter! ğŸŒŸ`,
    `Pertanyaan bagus! ğŸŒŸ Sayangnya database-ku belum mencakup area itu.\n\nCoba tanya dengan kata kunci berbeda, atau pilih dari:\nğŸ“š Kategori lengkap di tombol chip atas\nğŸ® Fitur interaktif di sidebar kiri\nğŸ”¢ Kalkulator di header\n\nAku siap membantu! ğŸ˜Š`
  ];
  return r[Math.floor(Math.random()*r.length)];
}

// ================================================================
//  FORMAT & UI
// ================================================================
function fmt(text) {
  text = text.replace(/\*\*(.*?)\*\*/g,'<strong>$1</strong>');
  text = text.replace(/\*(.*?)\*/g,'<span class="hl">$1</span>');
  text = text.replace(/```(\w+)?\n?([\s\S]*?)```/g,'<pre>$2</pre>');
  text = text.replace(/`([^`\n]+)`/g,'<span class="ci">$1</span>');
  text = text.replace(/\n/g,'<br>');
  return text;
}
function esc(s){return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;')}
function getTime(){return new Date().toLocaleTimeString('id-ID',{hour:'2-digit',minute:'2-digit'})}

function addMsg(text, role) {
  if (!text) return;
  const w=document.getElementById('wel'); if(w) w.remove();
  const ca=document.getElementById('ca');
  const el=document.createElement('div');
  el.className=`m ${role}`;
  const av=role==='ai'?'ğŸŒŸ':'ğŸ˜Š';
  const name=role==='ai'?'NusantaraAI':(userName||'Kamu');
  const content=role==='ai'?fmt(text):esc(text);
  el.innerHTML=`
    <div class="mav">${av}</div>
    <div style="max-width:${role==='ai'?'90%':'76%'}">
      <div class="bbl">${content}</div>
      <div class="mmeta">${name} â€¢ ${getTime()}</div>
      ${role==='ai'?`<div class="react-btns"><button class="rbtn" onclick="react(this,'ğŸ‘')">ğŸ‘</button><button class="rbtn" onclick="react(this,'â¤ï¸')">â¤ï¸</button><button class="rbtn" onclick="react(this,'ğŸ¤”')">ğŸ¤”</button></div>`:''}
    </div>
  `;
  ca.appendChild(el);
  ca.scrollTop=ca.scrollHeight;
  msgCount++;
  if(role==='user') addHist(text);
  updateStats();
}

function react(btn, emoji) {
  btn.textContent = emoji + ' âœ“';
  btn.style.background='rgba(96,165,250,.2)';
  btn.style.color='var(--accent)';
  btn.disabled=true;
}

function addHist(text) {
  const hl=document.getElementById('hlist');
  const short=text.length>32?text.substring(0,32)+'...':text;
  const it=document.createElement('div');
  it.className='hi'; it.textContent='ğŸ’¬ '+short;
  it.onclick=()=>qs(text);
  if(hl.children.length===1&&hl.children[0].style?.textAlign==='center') hl.innerHTML='';
  hl.insertBefore(it,hl.firstChild);
  if(hl.children.length>25) hl.removeChild(hl.lastChild);
}

function showTyping() {
  const ca=document.getElementById('ca');
  const el=document.createElement('div');
  el.className='m ai'; el.id='typ';
  el.innerHTML=`<div class="mav">ğŸŒŸ</div><div><div class="bbl"><div class="twrap"><div class="td"></div><div class="td"></div><div class="td"></div></div></div></div>`;
  ca.appendChild(el);
  ca.scrollTop=ca.scrollHeight;
  return el;
}

async function send() {
  if (processing) return;
  const inp=document.getElementById('ui');
  const text=inp.value.trim();
  if (!text) return;
  processing=true;
  inp.value=''; inp.style.height='auto';
  addMsg(text,'user');
  const typ=showTyping();
  const resp=findResponse(text);
  const delay=600+Math.min((resp?resp.replace(/<[^>]*>/g,'').length:400)*0.4,1600);
  await new Promise(r=>setTimeout(r,delay));
  typ.remove();
  if(resp) addMsg(resp,'ai');
  processing=false;
}

function qs(text){document.getElementById('ui').value=text;send();}

// ================================================================
//  CALCULATOR
// ================================================================
let cExp='';
function ca(k){
  const d=document.getElementById('cdisp');
  if(k==='C'){cExp='';d.textContent='0';return;}
  if(k==='='){
    try{
      const r=Function('"use strict";return('+cExp.replace(/\^/g,'**')+')')();
      cExp=isNaN(r)||!isFinite(r)?'Error':String(parseFloat(r.toFixed(10)));
      d.textContent=cExp;
    }catch(e){d.textContent='Error';cExp='';}
    return;
  }
  cExp+=k; d.textContent=cExp;
}

// ================================================================
//  UI CONTROLS
// ================================================================
function toggleSide(){
  const s=document.getElementById('side');
  sideOpen=!sideOpen;
  s.classList.toggle('open',sideOpen);
}
function toggleTheme(){
  const h=document.documentElement;
  const dark=h.getAttribute('data-theme')==='dark';
  h.setAttribute('data-theme',dark?'light':'dark');
  document.querySelector('[title="Tema"]').textContent=dark?'ğŸŒ™':'â˜€ï¸';
}
function openModal(id){document.getElementById(id).classList.add('show');}
function closeModal(id){document.getElementById(id).classList.remove('show');}
// Click outside modal
document.querySelectorAll('.mdbg').forEach(bg=>{
  bg.addEventListener('click',e=>{if(e.target===bg)bg.classList.remove('show');});
});
function chipClick(btn,topic){
  document.querySelectorAll('.chip').forEach(c=>c.classList.remove('on'));
  btn.classList.add('on');
  const map={
    sains:"Jelaskan tentang DNA dan genetika modern",
    teknologi:"Ajarkan Python OOP dan list comprehension",
    sejarah:"Ceritakan lengkap sejarah proklamasi Indonesia",
    matematika:"Jelaskan kalkulus diferensial dengan contoh",
    bahasa:"Jelaskan sistem morfologi bahasa Indonesia",
    budaya:"Ceritakan tentang batik dan maknanya",
    kesehatan:"Panduan olahraga dan nutrisi berbasis sains",
    olahraga:"Prestasi bulu tangkis Indonesia di dunia",
    ekonomi:"Cara investasi yang aman untuk pemula",
    psikologi:"Jelaskan gaya parenting authoritative",
    motivasi:"Berikan cerita motivasi yang menginspirasi",
    trivia:"Fakta paling mengejutkan tentang alam semesta",
    geografi:"Fakta menarik tentang kepulauan Indonesia",
    memasak:"Resep nasi goreng spesial yang enak",
    hukum:"Jelaskan hierarki peraturan di Indonesia",
    parenting:"Tips mendidik anak usia 5-10 tahun",
    alam:"Keanekaragaman hayati hutan tropis Indonesia",
  };
  if(map[topic]){document.getElementById('ui').value=map[topic];document.getElementById('ui').focus();}
}
function clearHist(){document.getElementById('hlist').innerHTML='<div style="font-size:11px;color:var(--tm);padding:8px;text-align:center">Riwayat dihapus.</div>';}
document.getElementById('ca').addEventListener('click',()=>{if(sideOpen&&window.innerWidth<=680)toggleSide();});

// ================================================================
//  INPUT HANDLERS
// ================================================================
const uiEl=document.getElementById('ui');
uiEl.addEventListener('input',function(){this.style.height='auto';this.style.height=Math.min(this.scrollHeight,100)+'px';});
uiEl.addEventListener('keydown',e=>{if(e.key==='Enter'&&!e.shiftKey){e.preventDefault();send();}});

// Keyboard calc
document.addEventListener('keydown',e=>{
  if(document.getElementById('mdcalc').classList.contains('show')){
    const valid='0123456789+-*/.()';
    if(valid.includes(e.key)){e.preventDefault();ca(e.key);}
    else if(e.key==='Enter'){e.preventDefault();ca('=');}
    else if(e.key==='Escape'){e.preventDefault();closeModal('mdcalc');}
    else if(e.key==='Backspace'){e.preventDefault();cExp=cExp.slice(0,-1);document.getElementById('cdisp').textContent=cExp||'0';}
  }
});

// ================================================================
//  STATS
// ================================================================
function updateStats(){
  document.getElementById('st-msg').textContent=msgCount;
  document.getElementById('st-q').textContent=quizRight;
  document.getElementById('st-qt').textContent=quizTotal;
  document.getElementById('st-sc').textContent=totalScore;
  document.getElementById('st-mood').textContent=userMood;
}
setInterval(()=>{
  const e=Math.floor((Date.now()-sessionStart)/1000);
  document.getElementById('st-t').textContent=`${Math.floor(e/60)}:${(e%60).toString().padStart(2,'0')}`;
},1000);
</script>
</body>
</html>
